# 見面次數統計程式使用說明

## 程式說明

`00_complete_meeting_analysis.py` 是一個完整的見面次數統計程式，整合了所有改進邏輯：

1. **第一層篩選**：基本關鍵字評分（強訊號、地點、時間、弱訊號）
2. **第二層篩選**：二次關鍵字評分，排除誤判（疑問句、未來時間）
3. **第三層確認**：判斷是否確定見面（「到了」+「開門」或多次「到了」）
4. **最終統計**：以日期為單位去重，避免同一天多個檔案重複計算

## 使用方法

```bash
cd .github
python 00_complete_meeting_analysis.py
```

## 輸出檔案

程式會在 `analysis_results` 資料夾產生兩個 CSV 檔案：

### 1. `meeting_final_summary.csv` - 最終統計摘要

- **date**: 日期
- **meeting_count**: 確定見面次數（該日期算 1 次）
- **gray_count**: 疑似見面次數（該日期算 1 次）
- **status**: 狀態（確定見面 / 疑似見面）
- **confirmed_files**: 確定見面的檔案列表
- **gray_files**: 疑似見面的檔案列表
- **total_files**: 該日期的總檔案數

### 2. `meeting_detailed_analysis.csv` - 詳細分析

- **date**: 日期
- **file**: 檔案名稱
- **score1**: 第一層評分
- **level1**: 第一層分類（確定見面 / 疑似有見面 / 不確定 / 沒有見面）
- **hits1**: 第一層命中的關鍵字
- **score2**: 第二層評分
- **hits2**: 第二層命中的關鍵字
- **meeting_status**: 最終判斷（confirm / gray / exclude）
- **line_count**: 檔案行數

## 統計結果

根據最新執行結果：

- **總檔案數**：398 個
- **確定見面日期數**：63 次
- **疑似見面日期數**：146 次
- **總見面次數（確定）**：63 次
- **總見面次數（含疑似）**：209 次

## 改進功能

1. **誤判過濾**：自動排除疑問句（「你要現在來？」）和未來時間（「下週五」）
2. **多重確認**：需要「到了」+「開門」或多次「到了」才判定為確定見面
3. **日期去重**：同一天多個檔案（AM/PM）只算一次見面
4. **詳細記錄**：保留所有分析過程，方便後續檢查

## 注意事項

- 程式會自動處理兩種檔名格式：
  - `YYYY-MM-DD.txt`
  - `YYYY-M-D_週X.txt` 或 `YYYY-M-D_週X_AM.txt`
- 所有輸出檔案使用 UTF-8 with BOM 編碼，可直接用 Excel 開啟
