# Google Cloud 新專案設定清單

## 🎯 目標
為台股智能分析系統建立全新的 Google Cloud 專案，避開專案 `722816989754` 的封鎖問題。

---

## 📋 必須啟用的 API（按優先順序）

### 1️⃣ **Generative Language API**（最重要！）
**用途**：Gemini AI 股票分析

**設定步驟**：
1. 前往 https://aistudio.google.com/apikey
2. 點擊「**Create API key in new project**」
3. 複製 API Key（格式：`AIzaSy...`）
4. 更新到 `.env` 檔案的 `GEMINI_API_KEY`

**驗證方式**：
```bash
curl -X POST "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=你的KEY" -H "Content-Type: application/json" -d '{"contents":[{"parts":[{"text":"測試"}]}]}'
```
應該返回 AI 回應，而不是 403 錯誤。

---

### 2️⃣ **Custom Search API**（選用功能）
**用途**：搜索台股相關新聞

**設定步驟**：
1. 前往 https://console.cloud.google.com/（選擇新專案）
2. 進入「**API 和服務**」→「**程式庫**」
3. 搜索「**Custom Search API**」
4. 點擊「**啟用**」
5. 進入「**憑證**」→「**建立憑證**」→「**API 金鑰**」
6. 複製 API Key
7. （建議）點擊「限制金鑰」→ 選擇「Custom Search API」
8. 更新到 `.env` 檔案的 `GOOGLE_CSE_KEY`

**搜尋引擎設定**：
1. 前往 https://programmablesearchengine.google.com/
2. 檢查搜尋引擎 ID：`e1d24063d47114161`
3. 確認設定：
   - ✅ 搜尋整個網路
   - ✅ 語言：繁體中文
   - ✅ 區域：台灣

**驗證方式**：
```bash
curl "https://www.googleapis.com/customsearch/v1?key=你的KEY&cx=e1d24063d47114161&q=台積電&num=3"
```
應該返回搜尋結果，而不是 403 錯誤。

**限制**：免費版每天 100 次查詢

---

## ⚙️ 可能需要的設定

### 💳 帳單帳戶
某些 API 可能需要綁定帳單帳戶（即使使用免費額度）：

1. 前往 https://console.cloud.google.com/billing
2. 「**連結帳單帳戶**」
3. 設定付款方式（信用卡）

**注意**：
- Gemini API 有慷慨的免費額度（每分鐘 15 次請求）
- Custom Search API 免費額度：每天 100 次
- 只要在免費額度內，不會扣款

---

## ✅ 檢查清單

完成後請確認：

- [ ] **新 Gemini API Key** 已建立並測試成功
- [ ] **更新 `.env` 檔案** 的 `GEMINI_API_KEY`
- [ ] **執行測試**：`python test_all.py`
- [ ] **Telegram 通知** 正常（已設定完成 ✅）
- [ ] **Email 通知** 正常（已設定完成 ✅）
- [ ] （選用）Custom Search API 已啟用
- [ ] （選用）更新 `.env` 的 `GOOGLE_CSE_KEY`

---

## 🚀 完成後執行

```bash
# 完整測試
python test_all.py

# 正式運行
python main.py
```

---

## 📝 當前系統狀態

### ✅ 已完成
- YFinance 數據源
- FinMind 數據源（備援）
- Telegram 通知（@TGgu4_bot，Chat ID: 973067130）
- Email 通知（jhekai0420@gmail.com → jhehuei0427@gmail.com）
- 技術指標計算（MA、RSI、MACD、布林帶）

### ❌ 待修復
- Gemini AI 分析（需要新 API Key）
- 新聞搜索（選用，需要新 API Key）

### 📊 數據配置
- 股票清單：2330（台積電）、2454（聯發科）、0050（元大台灣50）
- FinMind Token：已設定
- Telegram Bot：@TGgu4_bot

---

## 💡 建議

1. **優先處理 Gemini API**：這是系統核心功能
2. **Custom Search 可以晚點**：新聞功能是選用的，系統不需要也能運作
3. **測試再測試**：每次更新 Key 後都執行 `python test_all.py`

---

## 📞 技術支援

如遇到問題，請檢查：
1. API Key 格式正確（以 `AIzaSy` 開頭）
2. API 已在 Google Cloud Console 啟用
3. 專案沒有被暫停或限制
4. 帳單帳戶已連結（如需要）

---

**最後更新**：2026-02-01
**系統版本**：GU4 台股智能分析系統 v1.0
