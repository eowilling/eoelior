# 🎤 ScreamKiller - 演唱會尖叫聲消除神器

> 使用 AI 技術自動分離並抑制演唱會影片中的觀眾尖叫聲，保留歌手原聲

## ✨ 特色功能

- 🧠 **AI 音軌分離** - 使用 Demucs 深度學習模型精準分離人聲
- 🎚️ **智能音量控制** - 基於參考片段的動態限制器
- 🎯 **精準抑制** - 可指定特定時間段加強處理
- ⚡ **極速合成** - 視頻不重新編碼，保持原始畫質
- 🖥️ **友好界面** - 基於 Streamlit 的網頁操作介面

## 📋 系統需求

- Windows 10/11
- Python 3.9 或以上
- 8GB+ RAM (建議 16GB)
- 5GB+ 可用磁碟空間

## 🚀 快速開始

### 方法一：一鍵啟動（推薦）

1. 雙擊執行 `開始執行.cmd`
2. 首次執行會自動安裝所需套件（約 3-5 分鐘）
3. 瀏覽器自動開啟操作介面

### 方法二：手動安裝

```batch
# 1. 創建虛擬環境
python -m venv venv

# 2. 啟動虛擬環境
venv\\Scripts\\activate

# 3. 安裝依賴
pip install -r requirements.txt

# 4. 啟動應用
streamlit run scream_killer_web.py
```

## 📖 使用指南

### 步驟 1: 上傳影片
- 支援格式：MP4, MOV
- 建議檔案大小：< 500MB
- 建議長度：< 10 分鐘

### 步驟 2: 選擇模式

#### 模式 A：手動調整模式
- 簡單直接，適合快速處理
- 調整人聲保留比例滑桿
- 適用於整體音量控制

#### 模式 B：智能參考模式 ⭐推薦
1. **設定參考片段**（必填）
   - 選擇歌手清唱或主唱的段落
   - 建議 5-15 秒長度
   - 可設置多個參考片段
   - 範例：`00:10` - `00:15`

2. **設定抑制區**（選填）
   - 標記尖叫聲特別大的時段
   - 該區域會進行強力處理
   - 範例：`01:23` - `01:28`

### 步驟 3: 處理與下載
- 點擊 🚀 開始處理
- 等待進度完成（約 2-5 分鐘/3分鐘影片）
- 下載處理後的影片

## 🎯 使用技巧

### 最佳實踐
✅ **參考片段選擇**
- 選擇歌手獨唱部分
- 避免有和音或合唱的段落
- 音質清晰、無雜音最佳

✅ **抑制區設置**
- 只標記最嚴重的尖叫段落
- 不要覆蓋整首歌
- 可完全不設定（系統會自動處理）

✅ **時間輸入格式**
- 秒數：`30`
- 分:秒：`01:30`
- 時:分:秒：`01:30:45`

### 常見問題

**Q: 處理很慢怎麼辦？**
A: 這是正常現象，AI 模型需要時間分析音訊。建議處理時不要進行其他高負載任務。

**Q: 結果不理想怎麼辦？**
A: 嘗試調整參考片段，選擇更清晰的歌手獨唱段落，或增加/調整抑制區範圍。

**Q: 支援其他格式嗎？**
A: 目前僅支援 MP4 和 MOV。其他格式請先轉換。

**Q: 會影響畫質嗎？**
A: 不會。視頻採用 copy 模式，不重新編碼，畫質保持原樣。

**Q: 可以離線使用嗎？**
A: 首次使用需要網路下載模型和 FFmpeg，之後可離線使用。

## 🔧 技術架構

```
輸入影片
    ↓
[Demucs AI 音軌分離]
    ├→ vocals.wav (人聲)
    └→ no_vocals.wav (伴奏)
    ↓
[智能音量控制]
    ├→ 參考片段分析
    ├→ 動態限制器處理
    └→ 區段強化抑制
    ↓
[音訊混音與標準化]
    ↓
[FFmpeg 視頻合成]
    ├→ 視頻流直接複製
    ├→ 音訊重新編碼
    └→ 加入混響效果
    ↓
輸出影片
```

## 📦 專案結構

```
scream_killer_app/
├── scream_killer_web.py    # 主程式
├── requirements.txt         # Python 依賴
├── 開始執行.cmd              # 啟動腳本
├── AllinOne.cmd            # 完整安裝腳本
├── install_and_run.cmd     # 一鍵安裝腳本
├── OPTIMIZATION_LOG.md     # 優化記錄
└── README.md               # 本檔案
```

## 🛠️ 依賴套件

- **streamlit** - 網頁界面框架
- **demucs** - AI 音軌分離引擎
- **pydub** - 音訊處理庫
- **torch** - 深度學習框架
- **FFmpeg** - 視頻處理工具

## 📊 性能參數

| 影片長度 | 處理時間 | 記憶體使用 |
|---------|---------|-----------|
| 3 分鐘  | 2-5 分鐘 | ~2-3 GB   |
| 5 分鐘  | 3-8 分鐘 | ~3-4 GB   |
| 10 分鐘 | 6-15 分鐘| ~4-6 GB   |

*實際時間視電腦配置而定*

## 🔄 版本歷史

### v2.2 (2026-01-29) - 優化版
- ✅ 重構代碼架構
- ✅ 增強錯誤處理
- ✅ 優化處理性能
- ✅ 改善用戶界面
- ✅ 增加日誌系統

### v2.1
- 修復 AudioSegment 合併問題
- 增加 FFmpeg 混響效果
- 優化視頻合成速度

### v2.0
- 新增智能參考模式
- 支援多段參考片段
- 增加強力抑制區功能

### v1.0
- 初始版本
- 基礎音軌分離功能

## ⚠️ 注意事項

1. **版權聲明**：本工具僅供個人使用，請勿用於商業用途或侵犯版權
2. **處理時間**：AI 處理需要時間，請耐心等待
3. **檔案備份**：建議保留原始影片備份
4. **效果限制**：極端情況下可能無法完全消除尖叫聲

## 📞 技術支援

如遇到問題，請檢查：
1. Python 版本是否 >= 3.9
2. 磁碟空間是否充足
3. 記憶體是否足夠
4. 防毒軟體是否攔截

## 📄 授權

本專案僅供學習和個人使用。

---

**享受純淨的演唱會音質！** 🎵✨
