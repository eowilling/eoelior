(()=>{"use strict";var e={23:e=>{e.exports=require("util")},65:function(e,t,r){var s,n=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=s(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.EmulatorConsole=void 0;const o=i(r(278)),d=i(r(896)),c=i(r(928)),u=i(r(857));t.EmulatorConsole=class{constructor(e){this.logger=e,this.socket=null,this.authToken=null,this.connected=!1,this.authenticated=!1,this.responseBuffer="",this.pendingResolve=null,this.loadAuthToken()}loadAuthToken(){try{const e=c.join(u.homedir(),".emulator_console_auth_token");this.authToken=d.readFileSync(e,"utf8").trim()}catch{this.logger.warn("Could not load emulator auth token")}}async connect(e=5554){return!(!this.connected||!this.socket)||(this.authToken?new Promise(t=>{this.socket=new o.Socket,this.socket.setTimeout(5e3),this.socket.on("connect",async()=>{this.connected=!0,this.logger.info("Connected to emulator console"),await this.waitForResponse(),(await this.sendCommand(`auth ${this.authToken}`)).includes("OK")?(this.authenticated=!0,this.logger.info("Authenticated with emulator console"),t(!0)):(this.logger.warn("Failed to authenticate with emulator console"),this.disconnect(),t(!1))}),this.socket.on("data",e=>{if(this.responseBuffer+=e.toString(),this.pendingResolve&&this.responseBuffer.includes("OK")){const e=this.responseBuffer;this.responseBuffer="",this.pendingResolve(e),this.pendingResolve=null}}),this.socket.on("error",e=>{this.logger.warn(`Console socket error: ${e.message}`),this.connected=!1,this.authenticated=!1,t(!1)}),this.socket.on("close",()=>{this.connected=!1,this.authenticated=!1}),this.socket.on("timeout",()=>{this.logger.warn("Console socket timeout"),this.disconnect(),t(!1)}),this.socket.connect(e,"127.0.0.1")}):(this.logger.warn("No auth token available"),!1))}waitForResponse(){return new Promise(e=>{this.pendingResolve=e,setTimeout(()=>{if(this.pendingResolve){const t=this.responseBuffer;this.responseBuffer="",this.pendingResolve=null,e(t)}},2e3)})}async sendCommand(e){if(!this.socket||!this.connected)throw new Error("Not connected");return this.responseBuffer="",this.socket.write(e+"\n"),this.waitForResponse()}async tap(e,t){if(!(this.authenticated&&this.socket||await this.connect()))return!1;if(!this.socket)return this.logger.warn("Console tap failed: socket not available"),!1;try{return this.socket.write(`event mouse ${Math.round(e)} ${Math.round(t)} 0 1\n`),this.socket.write(`event mouse ${Math.round(e)} ${Math.round(t)} 0 0\n`),!0}catch(e){return this.logger.warn(`Console tap failed: ${e}`),!1}}async swipe(e){const{startX:t,startY:r,endX:s,endY:n,durationMs:a=100}=e;if(!(this.authenticated&&this.socket||await this.connect()))return!1;if(!this.socket)return this.logger.warn("Console swipe failed: socket not available"),!1;try{const e=Math.max(5,Math.floor(a/16)),i=(s-t)/e,o=(n-r)/e;this.socket.write(`event mouse ${Math.round(t)} ${Math.round(r)} 0 1\n`);for(let s=1;s<=e;s++){const e=Math.round(t+i*s),n=Math.round(r+o*s);this.socket.write(`event mouse ${e} ${n} 0 1\n`)}return this.socket.write(`event mouse ${Math.round(s)} ${Math.round(n)} 0 0\n`),!0}catch(e){return this.logger.warn(`Console swipe failed: ${e}`),!1}}async sendText(e){if(!(this.authenticated&&this.socket||await this.connect()))return!1;if(!this.socket)return this.logger.warn("Console sendText failed: socket not available"),!1;try{const t=e.replace(/[\r\n]/g," ");return this.socket.write(`event text ${t}\n`),!0}catch(e){return this.logger.warn(`Console text failed: ${e}`),!1}}disconnect(){this.socket&&(this.socket.write("quit\n"),this.socket.destroy(),this.socket=null),this.connected=!1,this.authenticated=!1}dispose(){this.disconnect()}}},146:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),s={};for(const e of r)s[e]=t[e];return e.objectValues(s)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(r=t.util||(t.util={})),(t.objectUtil||(t.objectUtil={})).mergeShapes=(e,t)=>({...e,...t}),t.ZodParsedType=r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),t.getParsedType=e=>{switch(typeof e){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":return Array.isArray(e)?t.ZodParsedType.array:null===e?t.ZodParsedType.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?t.ZodParsedType.promise:"undefined"!=typeof Map&&e instanceof Map?t.ZodParsedType.map:"undefined"!=typeof Set&&e instanceof Set?t.ZodParsedType.set:"undefined"!=typeof Date&&e instanceof Date?t.ZodParsedType.date:t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}},184:function(e,t,r){var s,n=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=s(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){const t=o.window.createOutputChannel("Cursor Android Emulator Connect");I=new u.ExtensionLogger(t);const r=o.window.registerWebviewPanelSerializer(p.EmulatorWebviewPanel.viewType,{async deserializeWebviewPanel(t,r){if(!S){S=new c.AndroidEmulatorController(I,e);try{await S.initialize()}catch(e){I?.warn("ADB initialization failed during restore",e)}}O=p.EmulatorWebviewPanel.restore(t,e.extensionUri,S,I),O.onDispose?.(()=>{O=null})}});e.subscriptions.push(r);const s=o.commands.registerCommand("cursor-android-emulator-connect.showLog",()=>{I?.show()}),n=o.commands.registerCommand("cursor-android-emulator-connect.openDockedView",async()=>{if(!I)return;if(O)return void O.reveal();if(!S){S=new c.AndroidEmulatorController(I,e);try{await S.initialize()}catch(e){I.warn("ADB initialization failed, some features may be limited",e)}}let t=await S.getConnectedDevices();if(0===t.length){const e=await S.listAvailableEmulators();if(e.error||0===e.emulators.length)return void o.window.showWarningMessage("No Android emulators available. Create one in Android Studio first.");const r=e.emulators[0],s=await o.window.withProgress({location:o.ProgressLocation.Notification,title:`Android Emulator: Starting ${r}...`,cancellable:!1},async()=>S.startEmulator(r));if(!s.success)return void o.window.showWarningMessage(s.error||"Failed to start Android emulator.");if(await o.window.withProgress({location:o.ProgressLocation.Notification,title:"Android Emulator: Waiting for boot...",cancellable:!1},async()=>{for(let e=0;e<30;e++)if(await new Promise(e=>setTimeout(e,2e3)),t=await S.getConnectedDevices(),t.length>0)return}),0===t.length)return void o.window.showWarningMessage("Emulator is starting. Please try again in a few seconds.");o.window.showInformationMessage(`Started Android Emulator: ${r}`)}O=p.EmulatorWebviewPanel.create(e.extensionUri,S,I),O.onDispose?.(()=>{O=null})});e.subscriptions.push(t,s,n);const a=async()=>{A&&await A,A=(async()=>{const t=Z();if(t&&!T){S=new c.AndroidEmulatorController(I,e);try{await S.initialize()}catch(e){I?.warn("ADB initialization failed, some features may be limited",e)}if(!Z())return await S.dispose(),void(S=null);T=new P(S,I),C=o.cursor.registerMcpProvider(T)}else!t&&T&&(C&&(C.dispose(),C=null),S&&(await S.dispose(),S=null),T=null)})();try{await A}finally{A=null}};a();const i=o.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration(h)&&a()});e.subscriptions.push(i)},t.deactivate=async function(){A&&await A,C&&(C.dispose(),C=null),S&&(await S.dispose(),S=null),T&&(await T.dispose(),T=null),I=null};const o=i(r(398)),d=r(614),c=r(545),u=r(377),l=r(970),p=r(589),h="cursor.androidEmulator.enabled",m=d.z.object({format:d.z.enum(["png"]).optional().describe("Image format for the screenshot. Currently only png is supported.")}).default({}),f=d.z.object({x:d.z.number().describe("X coordinate in device screen pixels. Use accessibility snapshot to get element bounds."),y:d.z.number().describe("Y coordinate in device screen pixels. Use accessibility snapshot to get element bounds."),holdMs:d.z.number().min(0).max(5e3).optional().describe("Duration to hold the tap in milliseconds (0-5000). Default is 0 (instant tap).")}),g=d.z.object({startX:d.z.number().describe("Starting X coordinate in device screen pixels"),startY:d.z.number().describe("Starting Y coordinate in device screen pixels"),endX:d.z.number().describe("Ending X coordinate in device screen pixels"),endY:d.z.number().describe("Ending Y coordinate in device screen pixels"),durationMs:d.z.number().min(50).max(2e3).optional().describe("Duration of the swipe in milliseconds (50-2000). Default is 300.")}),y=d.z.object({text:d.z.string().describe("Text to type into the emulator. The emulator must have a text field focused.")}),v=d.z.object({key:d.z.string().describe("Key to press. Supported: enter, return, tab, space, backspace, delete, escape, up, down, left, right, home, back, menu, search, volume_up, volume_down, power, camera, app_switch, or any single character")}),_=d.z.object({maxDepth:d.z.number().min(1).max(20).optional().describe("Maximum depth to traverse the UI hierarchy (1-20). Default is 10."),maxChildrenPerNode:d.z.number().min(1).max(100).optional().describe("Maximum number of children to include per node (1-100). Default is 50.")}).default({}),b=d.z.object({packageName:d.z.string().describe('The app package name (e.g., "com.android.chrome", "com.google.android.youtube").'),activityName:d.z.string().optional().describe('Optional: specific activity to launch (e.g., "com.google.android.apps.chrome.Main").')}),w=d.z.object({timeoutMs:d.z.number().min(100).max(3e4).optional().describe("Maximum time to wait in milliseconds (100-30000). Default is 5000.")}).default({}),x=d.z.object({avdName:d.z.string().describe("The name of the Android Virtual Device (AVD) to start. Use android_emulator_list_avds to see available emulators.")}),k=d.z.object({timeoutMs:d.z.number().min(1e3).max(3e5).optional().describe("Maximum time to wait for boot in milliseconds (1000-300000). Default is 120000 (2 minutes).")}).default({});function Z(){return o.workspace.getConfiguration().get(h,!1)}class P{constructor(e,t){this.controller=e,this.logger=t,this.id="cursor-android-emulator-connect",this.featureGateName="android_emulator_mcp_provider",this.tools=(0,l.createMcpTools)({android_emulator_screenshot:{description:"Capture a visual screenshot from the Android Emulator.\n\nIMPORTANT: In most cases, prefer using android_emulator_snapshot instead of this tool. The UI hierarchy snapshot provides structured data about UI elements (text, resource-ids, bounds) which is more useful for understanding the UI and determining tap coordinates. Only use screenshots when you need to see visual details like colors, images, or layout that aren't captured in the UI hierarchy.\n\nReturns the image as base64-encoded PNG data.",params:m,impl:async e=>{const t=e.format??"png",r=await this.controller.captureScreenshot(t);return{content:[{type:"image",data:r.base64Data,mimeType:r.mimeType}]}}},android_emulator_tap:{description:"Perform a tap at the specified coordinates in the Android Emulator.\n\nIMPORTANT:\n- Coordinates are in DEVICE SCREEN PIXELS. Use android_emulator_snapshot to get element bounds.\n- NEVER run tap/swipe/type/key actions in parallel. Always wait for one action to complete before starting the next.\n- Does NOT move the user's mouse cursor.\n\nTypical screen sizes vary by device. Use the UI hierarchy snapshot's \"frame\" data to find exact element positions.",params:f,impl:async e=>{const t=e,r=await this.controller.tap(t);return r.success?{content:[{type:"text",text:`Tapped at (${r.x}, ${r.y}) using ${r.method??"unknown"} method.`}]}:{content:[{type:"text",text:`Tap failed: ${r.error}`}],isError:!0}}},android_emulator_swipe:{description:"Perform a swipe gesture from start to end coordinates on the Android Emulator.\n\nIMPORTANT:\n- Coordinates are in DEVICE SCREEN PIXELS.\n- NEVER run tap/swipe/type/key actions in parallel. Always wait for one action to complete before starting the next.\n- Does NOT move the user's mouse cursor.\n\nUseful for scrolling (swipe up/down) or navigating (swipe left/right).",params:g,impl:async e=>{const t=e,r=await this.controller.swipe(t);return r.success?{content:[{type:"text",text:`Swiped from (${r.startX}, ${r.startY}) to (${r.endX}, ${r.endY}) using ${r.method??"unknown"} method.`}]}:{content:[{type:"text",text:`Swipe failed: ${r.error}`}],isError:!0}}},android_emulator_type:{description:"Type text into the Android Emulator.\n\nIMPORTANT:\n- A text field must be focused before typing. Use tap to focus a text field first.\n- NEVER run tap/swipe/type/key actions in parallel. Always wait for one action to complete before starting the next.\n- Special characters may not work correctly. For best results, use alphanumeric characters.",params:y,impl:async e=>{const t=e,r=await this.controller.typeText(t);return r.success?{content:[{type:"text",text:`Typed "${r.text}" into emulator`}]}:{content:[{type:"text",text:`Type failed: ${r.error}`}],isError:!0}}},android_emulator_press_key:{description:"Press a specific key in the Android Emulator.\n\nIMPORTANT:\n- NEVER run tap/swipe/type/key actions in parallel. Always wait for one action to complete before starting the next.\n\nSupported keys: enter, return, tab, space, backspace, delete, escape, up, down, left, right, home, back, menu, search, volume_up, volume_down, power, camera, app_switch, or any single character.",params:v,impl:async e=>{const t=e,r=await this.controller.pressKey(t.key);return r.success?{content:[{type:"text",text:`Pressed key: ${r.key}`}]}:{content:[{type:"text",text:`Key press failed: ${r.error}`}],isError:!0}}},android_emulator_snapshot:{description:"Capture a UI hierarchy snapshot of the Android Emulator. THIS IS THE PREFERRED WAY to understand the emulator's current UI state.\n\nReturns structured JSON data about ALL UI elements including:\n- class: The View class name (Button, TextView, EditText, etc.)\n- text: The text content of the element (use this to find buttons by label)\n- resource-id: The resource ID (e.g., \"com.android.chrome:id/ack_button\")\n- content-desc: Accessibility content description\n- frame: The element's position and size in pixels {x, y, width, height}\n- clickable, enabled, focused, scrollable: State flags\n\nTo tap an element, calculate the center of its frame:\n  centerX = frame.x + (frame.width / 2)\n  centerY = frame.y + (frame.height / 2)\n\nIMPORTANT: The snapshot captures the COMPLETE UI hierarchy. If you don't see expected elements:\n1. The element might be offscreen - try scrolling\n2. The element might be in a WebView (web content) which uiautomator cannot inspect\n3. Consider using android_emulator_screenshot for visual confirmation\n\nPrefer this over screenshots for finding tap coordinates - it provides exact bounds data.",params:_,impl:async e=>{const t=e,r={maxDepth:t.maxDepth,maxChildrenPerNode:t.maxChildrenPerNode},s=await this.controller.accessibilitySnapshot(r);return s.error?{content:[{type:"text",text:`UI hierarchy snapshot failed: ${s.error}`}],isError:!0}:{content:[{type:"text",text:JSON.stringify(s,null,2)}]}}},android_emulator_list_devices:{description:"List all connected Android devices and emulators. Use this to verify a device is connected before attempting other actions.\n\nIf no devices are found, use android_emulator_list_avds to see available emulators, then android_emulator_start to start one.",params:d.z.object({}).default({}),impl:async()=>{const e=await this.controller.getConnectedDevices();return 0===e.length?{content:[{type:"text",text:"No connected Android devices or emulators found. Use android_emulator_list_avds to see available emulators."}]}:{content:[{type:"text",text:`Connected devices: \n${e.map(e=>`- ${e.model} (${e.serial})`).join("\n")}`}]}}},android_emulator_launch_app:{description:"Launch an app by its package name.\n\nCommon package names:\n- com.android.chrome (Chrome browser)\n- com.android.settings (Settings)\n- com.google.android.youtube (YouTube)\n- com.google.android.apps.photos (Google Photos)\n- com.android.vending (Play Store)\n\nUse this to switch between apps or launch a specific app.",params:b,impl:async e=>{const t=e,r=await this.controller.launchApp(t.packageName,t.activityName);return r.success?{content:[{type:"text",text:`Launched app: ${t.packageName}`}]}:{content:[{type:"text",text:`Failed to launch app: ${r.error}`}],isError:!0}}},android_emulator_wait_for_idle:{description:"Wait for the device UI to become idle (no animations or pending events).\n\nUse this after tap, swipe, or navigation actions to ensure the UI has settled before taking a snapshot or performing the next action. This helps avoid capturing intermediate states.",params:w,impl:async e=>{const t=e,r=await this.controller.waitForIdle(t.timeoutMs);return r.success?{content:[{type:"text",text:"Device UI is now idle."}]}:{content:[{type:"text",text:`Wait for idle failed: ${r.error}`}],isError:!0}}},android_emulator_list_avds:{description:"List all available Android Virtual Devices (AVDs/emulators) that can be started.\n\nUse this to find available emulators when no device is connected. Then use android_emulator_start to launch one.",params:d.z.object({}).default({}),impl:async()=>{const e=await this.controller.listAvailableEmulators();return e.error?{content:[{type:"text",text:`Failed to list emulators: ${e.error}`}],isError:!0}:0===e.emulators.length?{content:[{type:"text",text:"No Android Virtual Devices found. Please create one using Android Studio."}]}:{content:[{type:"text",text:`Available emulators:\n${e.emulators.map(e=>`- ${e}`).join("\n")}`}]}}},android_emulator_start:{description:"Start an Android emulator by AVD name.\n\nThis starts the emulator in the background. After calling this, use android_emulator_wait_for_boot to wait for it to fully boot, then android_emulator_list_devices to verify it's connected.\n\nTypical workflow:\n1. android_emulator_list_avds (find available emulators)\n2. android_emulator_start (start the emulator)\n3. android_emulator_wait_for_boot (wait for it to boot)\n4. android_emulator_list_devices (verify connection)",params:x,impl:async e=>{const t=e,r=await this.controller.startEmulator(t.avdName);return r.success?{content:[{type:"text",text:`Started emulator: ${t.avdName}. Use android_emulator_wait_for_boot to wait for it to fully boot.`}]}:{content:[{type:"text",text:`Failed to start emulator: ${r.error}`}],isError:!0}}},android_emulator_wait_for_boot:{description:"Wait for the Android emulator to fully boot and become ready.\n\nCall this after android_emulator_start. This will wait until the emulator has completed booting and the UI is ready for interaction.",params:k,impl:async e=>{const t=e,r=await this.controller.waitForBoot(t.timeoutMs);return r.success?{content:[{type:"text",text:"Emulator has booted and is ready."}]}:{content:[{type:"text",text:`Wait for boot failed: ${r.error}`}],isError:!0}}}})}async listOfferings(){return{tools:this.tools.offerings().map(e=>({name:e.name,description:e.description,parameters:e.parameters})),prompts:[],resources:[]}}async callTool(e,t){return this.tools.call(e,t)}async dispose(){}}let T=null,I=null,C=null,S=null,A=null,O=null},227:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=r(146),n=r(837);t.default=(e,t)=>{let r;switch(e.code){case n.ZodIssueCode.invalid_type:r=e.received===s.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case n.ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,s.util.jsonStringifyReplacer)}`;break;case n.ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${s.util.joinValues(e.keys,", ")}`;break;case n.ZodIssueCode.invalid_union:r="Invalid input";break;case n.ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${s.util.joinValues(e.options)}`;break;case n.ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${s.util.joinValues(e.options)}, received '${e.received}'`;break;case n.ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case n.ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case n.ZodIssueCode.invalid_date:r="Invalid date";break;case n.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:s.util.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case n.ZodIssueCode.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case n.ZodIssueCode.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case n.ZodIssueCode.custom:r="Invalid input";break;case n.ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case n.ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case n.ZodIssueCode.not_finite:r="Number must be finite";break;default:r=t.defaultError,s.util.assertNever(e)}return{message:r}}},231:function(e,t,r){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=t.isValid=t.isDirty=t.isAborted=t.OK=t.DIRTY=t.INVALID=t.ParseStatus=t.addIssueToContext=t.EMPTY_PATH=t.makeIssue=void 0;const n=r(627),a=s(r(227));t.makeIssue=e=>{const{data:t,path:r,errorMaps:s,issueData:n}=e,a=[...r,...n.path||[]],i={...n,path:a};if(void 0!==n.message)return{...n,path:a,message:n.message};let o="";const d=s.filter(e=>!!e).slice().reverse();for(const e of d)o=e(i,{data:t,defaultError:o}).message;return{...n,path:a,message:o}},t.EMPTY_PATH=[],t.addIssueToContext=function(e,r){const s=(0,n.getErrorMap)(),i=(0,t.makeIssue)({issueData:r,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,s,s===a.default?void 0:a.default].filter(e=>!!e)});e.common.issues.push(i)};class i{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,r){const s=[];for(const n of r){if("aborted"===n.status)return t.INVALID;"dirty"===n.status&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const r=[];for(const e of t){const t=await e.key,s=await e.value;r.push({key:t,value:s})}return i.mergeObjectSync(e,r)}static mergeObjectSync(e,r){const s={};for(const n of r){const{key:r,value:a}=n;if("aborted"===r.status)return t.INVALID;if("aborted"===a.status)return t.INVALID;"dirty"===r.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===r.value||void 0===a.value&&!n.alwaysSet||(s[r.value]=a.value)}return{status:e.value,value:s}}}t.ParseStatus=i,t.INVALID=Object.freeze({status:"aborted"}),t.DIRTY=e=>({status:"dirty",value:e}),t.OK=e=>({status:"valid",value:e}),t.isAborted=e=>"aborted"===e.status,t.isDirty=e=>"dirty"===e.status,t.isValid=e=>"valid"===e.status,t.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},278:e=>{e.exports=require("net")},317:e=>{e.exports=require("child_process")},377:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionLogger=void 0,t.ExtensionLogger=class{constructor(e){this.outputChannel=e}formatTimestamp(){return(new Date).toISOString()}formatMessage(e,t,r){let s=`[${this.formatTimestamp()}] [${e}] ${t}`;if(void 0!==r)try{s+=` ${JSON.stringify(r,null,2)}`}catch{s+=" [Unserializable data]"}return s}info(e,t){const r=this.formatMessage("INFO",e,t);this.outputChannel.appendLine(r),console.log(r)}warn(e,t){const r=this.formatMessage("WARN",e,t);this.outputChannel.appendLine(r),console.warn(r)}error(e,t){let r;if(t instanceof Error)r=`${t.message}\n${t.stack??""}`;else if(void 0!==t)try{r=JSON.stringify(t,null,2)}catch{r=String(t)}const s=this.formatMessage("ERROR",e,r);this.outputChannel.appendLine(s),console.error(s)}debug(e,t){const r=this.formatMessage("DEBUG",e,t);this.outputChannel.appendLine(r),console.debug(r)}show(){this.outputChannel.show()}}},398:e=>{e.exports=require("vscode")},522:(e,t,r)=>{r.r(t),r.d(t,{addErrorMessage:()=>o,default:()=>se,defaultOptions:()=>n,getDefaultOptions:()=>a,getRefs:()=>i,ignoreOverride:()=>s,parseAnyDef:()=>u,parseArrayDef:()=>l,parseBigintDef:()=>p,parseBooleanDef:()=>h,parseBrandedDef:()=>m,parseCatchDef:()=>f,parseDateDef:()=>g,parseDef:()=>J,parseDefaultDef:()=>v,parseEffectsDef:()=>_,parseEnumDef:()=>b,parseIntersectionDef:()=>x,parseLiteralDef:()=>k,parseMapDef:()=>D,parseNativeEnumDef:()=>M,parseNeverDef:()=>E,parseNullDef:()=>N,parseNullableDef:()=>L,parseNumberDef:()=>R,parseObjectDef:()=>z,parseOptionalDef:()=>F,parsePipelineDef:()=>K,parsePromiseDef:()=>B,parseReadonlyDef:()=>H,parseRecordDef:()=>O,parseSetDef:()=>W,parseStringDef:()=>T,parseTupleDef:()=>Y,parseUndefinedDef:()=>X,parseUnionDef:()=>$,parseUnknownDef:()=>q,primitiveMappings:()=>j,setResponseValueAndErrors:()=>d,zodPatterns:()=>P,zodToJsonSchema:()=>re});const s=Symbol("Let zodToJsonSchema decide on which parser to use"),n={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},a=e=>"string"==typeof e?{...n,name:e}:{...n,...e},i=e=>{const t=a(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}};function o(e,t,r,s){s?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function d(e,t,r,s,n){e[t]=r,o(e,t,s,n)}var c=r(614);function u(){return{}}function l(e,t){const r={type:"array"};return e.type?._def?.typeName!==c.ZodFirstPartyTypeKind.ZodAny&&(r.items=J(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&d(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&d(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(d(r,"minItems",e.exactLength.value,e.exactLength.message,t),d(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}function p(e,t){const r={type:"integer",format:"int64"};if(!e.checks)return r;for(const s of e.checks)switch(s.kind){case"min":"jsonSchema7"===t.target?s.inclusive?d(r,"minimum",s.value,s.message,t):d(r,"exclusiveMinimum",s.value,s.message,t):(s.inclusive||(r.exclusiveMinimum=!0),d(r,"minimum",s.value,s.message,t));break;case"max":"jsonSchema7"===t.target?s.inclusive?d(r,"maximum",s.value,s.message,t):d(r,"exclusiveMaximum",s.value,s.message,t):(s.inclusive||(r.exclusiveMaximum=!0),d(r,"maximum",s.value,s.message,t));break;case"multipleOf":d(r,"multipleOf",s.value,s.message,t)}return r}function h(){return{type:"boolean"}}function m(e,t){return J(e.type._def,t)}const f=(e,t)=>J(e.innerType._def,t);function g(e,t,r){const s=r??t.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((r,s)=>g(e,t,r))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return y(e,t)}}const y=(e,t)=>{const r={type:"integer",format:"unix-time"};if("openApi3"===t.target)return r;for(const s of e.checks)switch(s.kind){case"min":d(r,"minimum",s.value,s.message,t);break;case"max":d(r,"maximum",s.value,s.message,t)}return r};function v(e,t){return{...J(e.innerType._def,t),default:e.defaultValue()}}function _(e,t){return"input"===t.effectStrategy?J(e.schema._def,t):{}}function b(e){return{type:"string",enum:e.values}}const w=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e;function x(e,t){const r=[J(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),J(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e);let s="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0;const n=[];return r.forEach(e=>{if(w(e))n.push(...e.allOf),void 0===e.unevaluatedProperties&&(s=void 0);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){const{additionalProperties:r,...s}=e;t=s}else s=void 0;n.push(t)}}),n.length?{allOf:n,...s}:void 0}function k(e,t){const r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}let Z;const P={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===Z&&(Z=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Z),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function T(e,t){const r={type:"string"};function s(e){return"escape"===t.patternStrategy?I(e):e}if(e.checks)for(const n of e.checks)switch(n.kind){case"min":d(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,n.message,t);break;case"max":d(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case"email":switch(t.emailStrategy){case"format:email":C(r,"email",n.message,t);break;case"format:idn-email":C(r,"idn-email",n.message,t);break;case"pattern:zod":S(r,P.email,n.message,t)}break;case"url":C(r,"uri",n.message,t);break;case"uuid":C(r,"uuid",n.message,t);break;case"regex":S(r,n.regex,n.message,t);break;case"cuid":S(r,P.cuid,n.message,t);break;case"cuid2":S(r,P.cuid2,n.message,t);break;case"startsWith":S(r,RegExp(`^${s(n.value)}`),n.message,t);break;case"endsWith":S(r,RegExp(`${s(n.value)}$`),n.message,t);break;case"datetime":C(r,"date-time",n.message,t);break;case"date":C(r,"date",n.message,t);break;case"time":C(r,"time",n.message,t);break;case"duration":C(r,"duration",n.message,t);break;case"length":d(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,n.message,t),d(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value,n.message,t);break;case"includes":S(r,RegExp(s(n.value)),n.message,t);break;case"ip":"v6"!==n.version&&C(r,"ipv4",n.message,t),"v4"!==n.version&&C(r,"ipv6",n.message,t);break;case"emoji":S(r,P.emoji,n.message,t);break;case"ulid":S(r,P.ulid,n.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":C(r,"binary",n.message,t);break;case"contentEncoding:base64":d(r,"contentEncoding","base64",n.message,t);break;case"pattern:zod":S(r,P.base64,n.message,t)}break;case"nanoid":S(r,P.nanoid,n.message,t);case"toLowerCase":case"toUpperCase":case"trim":break;default:(()=>{})()}return r}const I=e=>Array.from(e).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),C=(e,t,r,s)=>{e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&s.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&s.errorMessages&&{errorMessage:{format:r}}})):d(e,"format",t,r,s)},S=(e,t,r,s)=>{e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&s.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:A(t,s),...r&&s.errorMessages&&{errorMessage:{pattern:r}}})):d(e,"pattern",A(t,s),r,s)},A=(e,t)=>{const r="function"==typeof e?e():e;if(!t.applyRegexFlags||!r.flags)return r.source;const s=r.flags.includes("i"),n=r.flags.includes("m"),a=r.flags.includes("s"),i=s?r.source.toLowerCase():r.source;let o="",d=!1,c=!1,u=!1;for(let e=0;e<i.length;e++)if(d)o+=i[e],d=!1;else{if(s)if(c){if(i[e].match(/[a-z]/)){u?(o+=i[e],o+=`${i[e-2]}-${i[e]}`.toUpperCase(),u=!1):"-"===i[e+1]&&i[e+2]?.match(/[a-z]/)?(o+=i[e],u=!0):o+=`${i[e]}${i[e].toUpperCase()}`;continue}}else if(i[e].match(/[a-z]/)){o+=`[${i[e]}${i[e].toUpperCase()}]`;continue}if(n){if("^"===i[e]){o+="(^|(?<=[\r\n]))";continue}if("$"===i[e]){o+="($|(?=[\r\n]))";continue}}a&&"."===i[e]?o+=c?`${i[e]}\r\n`:`[${i[e]}\r\n]`:(o+=i[e],"\\"===i[e]?d=!0:c&&"]"===i[e]?c=!1:c||"["!==i[e]||(c=!0))}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return o};function O(e,t){if("openApi3"===t.target&&e.keyType?._def.typeName===c.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,s)=>({...r,[s]:J(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",s]})??{}}),{}),additionalProperties:!1};const r={type:"object",additionalProperties:J(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??{}};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===c.ZodFirstPartyTypeKind.ZodString&&e.keyType._def.checks?.length){const s=Object.entries(T(e.keyType._def,t)).reduce((e,[t,r])=>"type"===t?e:{...e,[t]:r},{});return{...r,propertyNames:s}}return e.keyType?._def.typeName===c.ZodFirstPartyTypeKind.ZodEnum?{...r,propertyNames:{enum:e.keyType._def.values}}:r}function D(e,t){return"record"===t.mapStrategy?O(e,t):{type:"array",maxItems:125,items:{type:"array",items:[J(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},J(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}function M(e){const t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),s=Array.from(new Set(r.map(e=>typeof e)));return{type:1===s.length?"string"===s[0]?"string":"number":["string","number"],enum:r}}function E(){return{not:{}}}function N(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}const j={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function $(e,t){if("openApi3"===t.target)return U(e,t);const r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in j&&(!e._def.checks||!e._def.checks.length))){const e=r.reduce((e,t)=>{const r=j[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){const e=r.reduce((e,t)=>{const r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){const t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return U(e,t)}const U=(e,t)=>{const r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>J(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0};function L(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:j[e.innerType._def.typeName],nullable:!0}:{type:[j[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){const r=J(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const r=J(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function R(e,t){const r={type:"number"};if(!e.checks)return r;for(const s of e.checks)switch(s.kind){case"int":r.type="integer",o(r,"type",s.message,t);break;case"min":"jsonSchema7"===t.target?s.inclusive?d(r,"minimum",s.value,s.message,t):d(r,"exclusiveMinimum",s.value,s.message,t):(s.inclusive||(r.exclusiveMinimum=!0),d(r,"minimum",s.value,s.message,t));break;case"max":"jsonSchema7"===t.target?s.inclusive?d(r,"maximum",s.value,s.message,t):d(r,"exclusiveMaximum",s.value,s.message,t):(s.inclusive||(r.exclusiveMaximum=!0),d(r,"maximum",s.value,s.message,t));break;case"multipleOf":d(r,"multipleOf",s.value,s.message,t)}return r}function V(e,t){return"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:J(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:J(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??!0}function z(e,t){const r={type:"object",...Object.entries(e.shape()).reduce((e,[r,s])=>{if(void 0===s||void 0===s._def)return e;const n=J(s._def,{...t,currentPath:[...t.currentPath,"properties",r],propertyPath:[...t.currentPath,"properties",r]});return void 0===n?e:{properties:{...e.properties,[r]:n},required:s.isOptional()?e.required:[...e.required,r]}},{properties:{},required:[]}),additionalProperties:V(e,t)};return r.required.length||delete r.required,r}const F=(e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return J(e.innerType._def,t);const r=J(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},K=(e,t)=>{if("input"===t.pipeStrategy)return J(e.in._def,t);if("output"===t.pipeStrategy)return J(e.out._def,t);const r=J(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]});return{allOf:[r,J(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]})].filter(e=>void 0!==e)}};function B(e,t){return J(e.type._def,t)}function W(e,t){const r={type:"array",uniqueItems:!0,items:J(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&d(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&d(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function Y(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>J(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:J(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>J(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}function X(){return{not:{}}}function q(){return{}}const H=(e,t)=>J(e.innerType._def,t);function J(e,t,r=!1){const n=t.seen.get(e);if(t.override){const a=t.override?.(e,t,n,r);if(a!==s)return a}if(n&&!r){const e=G(n,t);if(void 0!==e)return e}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const i=ee(e,e.typeName,t);return i&&te(e,t,i),a.jsonSchema=i,i}const G=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Q(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):"seen"===t.$refStrategy?{}:void 0}},Q=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},ee=(e,t,r)=>{switch(t){case c.ZodFirstPartyTypeKind.ZodString:return T(e,r);case c.ZodFirstPartyTypeKind.ZodNumber:return R(e,r);case c.ZodFirstPartyTypeKind.ZodObject:return z(e,r);case c.ZodFirstPartyTypeKind.ZodBigInt:return p(e,r);case c.ZodFirstPartyTypeKind.ZodBoolean:return{type:"boolean"};case c.ZodFirstPartyTypeKind.ZodDate:return g(e,r);case c.ZodFirstPartyTypeKind.ZodUndefined:return{not:{}};case c.ZodFirstPartyTypeKind.ZodNull:return N(r);case c.ZodFirstPartyTypeKind.ZodArray:return l(e,r);case c.ZodFirstPartyTypeKind.ZodUnion:case c.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return $(e,r);case c.ZodFirstPartyTypeKind.ZodIntersection:return x(e,r);case c.ZodFirstPartyTypeKind.ZodTuple:return Y(e,r);case c.ZodFirstPartyTypeKind.ZodRecord:return O(e,r);case c.ZodFirstPartyTypeKind.ZodLiteral:return k(e,r);case c.ZodFirstPartyTypeKind.ZodEnum:return b(e);case c.ZodFirstPartyTypeKind.ZodNativeEnum:return M(e);case c.ZodFirstPartyTypeKind.ZodNullable:return L(e,r);case c.ZodFirstPartyTypeKind.ZodOptional:return F(e,r);case c.ZodFirstPartyTypeKind.ZodMap:return D(e,r);case c.ZodFirstPartyTypeKind.ZodSet:return W(e,r);case c.ZodFirstPartyTypeKind.ZodLazy:return J(e.getter()._def,r);case c.ZodFirstPartyTypeKind.ZodPromise:return B(e,r);case c.ZodFirstPartyTypeKind.ZodNaN:case c.ZodFirstPartyTypeKind.ZodNever:return{not:{}};case c.ZodFirstPartyTypeKind.ZodEffects:return _(e,r);case c.ZodFirstPartyTypeKind.ZodAny:case c.ZodFirstPartyTypeKind.ZodUnknown:return{};case c.ZodFirstPartyTypeKind.ZodDefault:return v(e,r);case c.ZodFirstPartyTypeKind.ZodBranded:return m(e,r);case c.ZodFirstPartyTypeKind.ZodReadonly:return H(e,r);case c.ZodFirstPartyTypeKind.ZodCatch:return f(e,r);case c.ZodFirstPartyTypeKind.ZodPipeline:return K(e,r);case c.ZodFirstPartyTypeKind.ZodFunction:case c.ZodFirstPartyTypeKind.ZodVoid:case c.ZodFirstPartyTypeKind.ZodSymbol:default:return}},te=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r),re=(e,t)=>{const r=i(t),s="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,s])=>({...e,[t]:J(s._def,{...r,currentPath:[...r.basePath,r.definitionPath,t]},!0)??{}}),{}):void 0,n="string"==typeof t?t:"title"===t?.nameStrategy?void 0:t?.name,a=J(e._def,void 0===n?r:{...r,currentPath:[...r.basePath,r.definitionPath,n]},!1)??{},o="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==o&&(a.title=o);const d=void 0===n?s?{...a,[r.definitionPath]:s}:a:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,n].join("/"),[r.definitionPath]:{...s,[n]:a}};return"jsonSchema7"===r.target?d.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===r.target&&(d.$schema="https://json-schema.org/draft/2019-09/schema#"),d},se=re},537:function(e,t,r){var s,n=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=s(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.MinicapManager=void 0;const o=i(r(317)),d=i(r(943)),c=i(r(278)),u=i(r(928)),l=(0,r(23).promisify)(o.execFile);t.MinicapManager=class{constructor(e,t){this.logger=e,this.extensionPath=t,this.status="not_installed",this.minicapApkPath=null,this.downloadPromise=null,this.minicapProcess=null,this.forwardPort=0,this.socket=null}getStatus(){return this.status}async ensureInstalled(){if("ready"===this.status&&this.minicapApkPath)return!0;if(this.downloadPromise)return await this.downloadPromise,"ready"===this.status;const e=function(e,t){const r=[],s=u.join(e,"dist","minicap.apk");r.push(s);const n=u.join(e,"node_modules","@devicefarmer","minicap-prebuilt","prebuilt","noarch","minicap.apk");return r.push(n),t.info(`Minicap APK candidate paths: ${r.join(", ")}`),r}(this.extensionPath,this.logger);for(const t of e)if(this.logger.info(`Checking for minicap APK at: ${t}`),await this.fileExists(t))return this.logger.info(`Found minicap APK at: ${t}`),this.minicapApkPath=t,this.status="ready",!0;return this.logger.error(`Minicap APK not found. Tried paths: ${e.join(", ")}`),this.status="not_installed",!1}async fileExists(e){try{return await d.access(e),!0}catch{return!1}}async startStreaming(e,t,r,s){if(!this.minicapApkPath)return this.logger.error("Minicap APK not available"),null;try{const n=await this.getDisplayInfo(e,t);if(!n)return this.logger.warn("Could not get display info"),null;await this.pushApk(e,t);const a=r/n.width,i=r,d=Math.floor(n.height*a),c=`${n.width}x${n.height}@${i}x${d}/0`;return this.logger.info(`Starting minicap: ${c}`),this.minicapProcess=o.spawn(e,["-s",t,"shell","CLASSPATH=/data/local/tmp/minicap.apk","app_process","/system/bin","io.devicefarmer.minicap.Main","-P",c],{stdio:["ignore","pipe","pipe"]}),await new Promise((e,t)=>{const r=setTimeout(()=>t(new Error("Minicap start timeout")),1e4);let s=!1;const n=t=>{const a=t.toString();this.logger.info(`minicap: ${a.trim()}`),s||!a.includes("Listening on socket")&&!a.includes("INFO:")||(s=!0,clearTimeout(r),this.minicapProcess.stderr.removeListener("data",n),setTimeout(()=>e(),200))};this.minicapProcess.stderr.on("data",n),this.minicapProcess.on("error",e=>{s||(clearTimeout(r),t(e))}),this.minicapProcess.on("exit",e=>{s||(clearTimeout(r),t(new Error(`Minicap exited unexpectedly with code ${e??"null"}`)))})}),this.forwardPort=1313+Math.floor(1e3*Math.random()),await l(e,["-s",t,"forward",`tcp:${this.forwardPort}`,"localabstract:minicap"]),this.logger.info(`Port forward: tcp:${this.forwardPort} -> localabstract:minicap`),this.connectToMinicap(s,e,t)}catch(r){return this.logger.error(`Minicap start failed: ${r instanceof Error?r.message:String(r)}`),this.cleanup(e,t),null}}connectToMinicap(e,t,r){return new Promise(s=>{this.socket=c.createConnection({port:this.forwardPort,host:"127.0.0.1"});let n=!1,a=Buffer.alloc(0),i=0,o=0,d=!1,u=Date.now();this.socket.on("connect",()=>{this.logger.info("Connected to minicap socket")}),this.socket.on("data",c=>{if(!d){if(a=Buffer.concat([a,c]),!n&&a.length>=24){const e=a.readUInt8(0),i=a.readUInt8(1),c=a.readUInt32LE(6),u=a.readUInt32LE(10),l=a.readUInt32LE(14),p=a.readUInt32LE(18);this.logger.info(`Minicap header: v${e}, real=${c}x${u}, virtual=${l}x${p}`),a=a.subarray(i),n=!0,s({stop:()=>{d=!0,this.cleanup(t,r),this.logger.info(`Minicap stopped after ${o} frames`)}})}for(;n&&a.length>=4&&(0===i&&(i=a.readUInt32LE(0),a=a.subarray(4)),a.length>=i);){const t=a.subarray(0,i);if(a=a.subarray(i),i=0,o++,e(t),o%30==0){const e=(3e4/(Date.now()-u)).toFixed(1);this.logger.info(`Minicap: ${o} frames, ~${e} FPS`),u=Date.now()}}}}),this.socket.on("error",e=>{this.logger.error(`Minicap socket error: ${e.message}`),n||s(null)}),this.socket.on("close",()=>{d||this.logger.info("Minicap socket closed")}),setTimeout(()=>{n||(this.logger.warn("Minicap connection timeout"),this.socket?.destroy(),s(null))},5e3)})}async getDisplayInfo(e,t){try{const{stdout:r}=await l(e,["-s",t,"shell","wm","size"]),s=r.match(/Physical size: (\d+)x(\d+)/);if(s)return{width:parseInt(s[1],10),height:parseInt(s[2],10)}}catch(e){this.logger.warn(`wm size failed: ${e}`)}try{const{stdout:r}=await l(e,["-s",t,"shell","dumpsys","display"]),s=r.match(/mDisplayWidth=(\d+)/),n=r.match(/mDisplayHeight=(\d+)/);if(s&&n)return{width:parseInt(s[1],10),height:parseInt(n[1],10)};const a=r.match(/real\s+(\d+)\s*x\s*(\d+)/);if(a)return{width:parseInt(a[1],10),height:parseInt(a[2],10)}}catch(e){this.logger.warn(`dumpsys display failed: ${e}`)}return this.logger.warn("Could not detect display size, using default 1080x1920"),{width:1080,height:1920}}async pushApk(e,t){if(this.minicapApkPath){try{const{stdout:r}=await l(e,["-s",t,"shell","ls","/data/local/tmp/minicap.apk"]);if(r.includes("minicap.apk"))return void this.logger.info("Minicap APK already on device")}catch{}this.logger.info("Pushing minicap APK to device..."),await l(e,["-s",t,"push",this.minicapApkPath,"/data/local/tmp/minicap.apk"])}}cleanup(e,t){this.socket&&(this.socket.destroy(),this.socket=null),this.minicapProcess&&(this.minicapProcess.kill(),this.minicapProcess=null),this.forwardPort>0&&(o.spawn(e,["-s",t,"forward","--remove",`tcp:${this.forwardPort}`]),this.forwardPort=0)}dispose(){this.socket&&(this.socket.destroy(),this.socket=null),this.minicapProcess&&(this.minicapProcess.kill(),this.minicapProcess=null)}}},545:function(e,t,r){var s,n=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=s(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.AndroidEmulatorController=void 0;const o=i(r(943)),d=i(r(857)),c=i(r(928)),u=r(641),l=r(918);t.AndroidEmulatorController=class{constructor(e,t){this.logger=e,this.context=t,this.tempDir=c.join(d.tmpdir(),"cursor-android-emulator-connect"),this.adbManager=new u.AdbManager(e,t.globalStorageUri.fsPath),this.screenStreamer=new l.ScreenStreamer(e,t.extensionPath)}async initialize(){try{await this.adbManager.ensureInstalled(),this.logger.info("ADB initialized, screen streaming ready")}catch(e){throw this.logger.error("Failed to initialize ADB",e),e}}async captureScreenshot(e="png"){await this.ensureDeviceConnected();const t=await this.adbManager.captureScreenshot();if(!t)throw new Error("Failed to capture screenshot. No device connected or screenshot failed.");return{base64Data:t.base64Data,mimeType:t.mimeType,capturedAt:(new Date).toISOString()}}async tap(e){await this.ensureDeviceConnected();const t=await this.adbManager.tap(e.x,e.y,e.holdMs??0);return{success:t.success,x:e.x,y:e.y,method:t.method,error:t.error}}async swipe(e){await this.ensureDeviceConnected();const t=await this.adbManager.swipe(e.startX,e.startY,e.endX,e.endY,e.durationMs??300);return{success:t.success,startX:e.startX,startY:e.startY,endX:e.endX,endY:e.endY,method:t.method,error:t.error}}async typeText(e){await this.ensureDeviceConnected();const t=await this.adbManager.typeText(e.text);return{text:e.text,success:t.success,error:t.error}}async pressKey(e){await this.ensureDeviceConnected();const t=await this.adbManager.pressKey(e);return{key:e,success:t.success,error:t.error}}async accessibilitySnapshot(e={}){await this.ensureDeviceConnected();const t=e.maxDepth??10,r=e.maxChildrenPerNode??50,s=await this.adbManager.getAccessibilityTree(t,r);return s.error?{capturedAt:(new Date).toISOString(),tree:{class:null,text:null,"resource-id":null,"content-desc":null,package:null,clickable:!1,enabled:!1,focused:!1,scrollable:!1,frame:null},error:s.error}:{capturedAt:s.capturedAt??(new Date).toISOString(),tree:s.tree}}async getConnectedDevices(){return(await this.adbManager.listDevices()).filter(e=>"device"===e.state).map(e=>({serial:e.serial,model:e.model||e.device||"Unknown",state:e.state}))}async launchApp(e,t){return await this.ensureDeviceConnected(),this.adbManager.launchApp(e,t)}async waitForIdle(e){return await this.ensureDeviceConnected(),this.adbManager.waitForIdle(e)}async listAvailableEmulators(){return this.adbManager.listAvailableEmulators()}async startEmulator(e){return this.adbManager.startEmulator(e)}async waitForBoot(e){return this.adbManager.waitForBoot(e)}async startScreenStream(e,t){const r=(await this.adbManager.listDevices()).find(e=>"device"===e.state);if(!r)return this.logger.warn("No connected device for screen streaming"),null;const s=this.adbManager.getAdbPath();return s?(this.logger.info("Starting screen stream (trying minicap, fallback to ADB)..."),await this.screenStreamer.startStreaming({deviceSerial:r.serial,adbPath:s,width:e.width??540},e=>{const r=255===e[0]&&216===e[1]?"image/jpeg":"image/png";t(e.toString("base64"),r)})):(this.logger.error("ADB path not available"),null)}isStreamingActive(){return this.screenStreamer.isStreaming()}stopScreenStream(){this.screenStreamer.stopCurrentStream()}async ensureTempDir(){await o.mkdir(this.tempDir,{recursive:!0})}async ensureDeviceConnected(){if(0===(await this.adbManager.listDevices()).filter(e=>"device"===e.state).length)throw new Error("No connected Android device or emulator found. Start an Android emulator or connect a device first.")}async dispose(){this.screenStreamer.dispose(),await this.adbManager.dispose();try{await o.rm(this.tempDir,{recursive:!0,force:!0})}catch{}}}},555:function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(627),t),n(r(231),t),n(r(892),t),n(r(146),t),n(r(739),t),n(r(837),t)},589:function(e,t,r){var s,n=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=s(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.EmulatorWebviewPanel=void 0;const o=i(r(398));class d{constructor(e,t,r,s){this.extensionUri=e,this.controller=t,this.logger=r,this.disposables=[],this.streaming=!1,this.targetFps=20,this.screenInfo={width:1080,height:2340},this.streamHandle=null,this._onDidDispose=new o.EventEmitter,this.onDispose=this._onDidDispose.event,this.isDisposed=!1,this.panel=s;const n=o.workspace.getConfiguration("cursor.androidEmulator");this.targetFps=n.get("dockedView.fps",20),this.disposables.push(this.panel.webview.onDidReceiveMessage(e=>this.handleWebviewMessage(e),void 0,this.disposables)),this.disposables.push(this.panel.onDidDispose(()=>{this.isDisposed||(this.isDisposed=!0,this.stopStreaming(),this._onDidDispose.fire(),this._onDidDispose.dispose())})),this.disposables.push(this.panel.onDidChangeViewState(e=>{e.webviewPanel.visible?this.startStreaming():this.stopStreaming()})),this.panel.webview.html=this.getHtmlContent()}static create(e,t,r){const s=o.window.createWebviewPanel(d.viewType,"Android Emulator",o.ViewColumn.Beside,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[o.Uri.joinPath(e,"media")]});return new d(e,t,r,s)}static restore(e,t,r,s){return e.webview.options={enableScripts:!0,localResourceRoots:[o.Uri.joinPath(t,"media")]},new d(t,r,s,e)}reveal(){this.panel.reveal()}dispose(){if(!this.isDisposed){this.isDisposed=!0,this.stopStreaming(),this._onDidDispose.fire(),this._onDidDispose.dispose();for(const e of this.disposables)e.dispose();this.panel.dispose()}}async handleWebviewMessage(e){try{switch(e.type){case"ready":this.startStreaming();break;case"tap":{const t=e.x*this.screenInfo.width,r=e.y*this.screenInfo.height;await this.controller.tap({x:t,y:r,holdMs:e.holdMs});break}case"swipe":{const t=e.startX*this.screenInfo.width,r=e.startY*this.screenInfo.height,s=e.endX*this.screenInfo.width,n=e.endY*this.screenInfo.height;await this.controller.swipe({startX:t,startY:r,endX:s,endY:n,durationMs:e.durationMs});break}case"key":{const t={Enter:"enter",Backspace:"backspace",Delete:"delete",Tab:"tab",Escape:"escape",ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",Home:"home"," ":"space"}[e.key];t?await this.controller.pressKey(t):1===e.key.length&&await this.controller.typeText({text:e.key});break}case"text":await this.controller.typeText({text:e.text});break;case"home":await this.controller.pressKey("home");break;case"back":await this.controller.pressKey("back");break;case"recents":await this.controller.pressKey("app_switch")}}catch(e){this.logger.error("Error handling webview message",e)}}async startStreaming(){if(this.streaming)return;this.streaming=!0,this.logger.info("Starting Android Emulator streaming");let e=0;const t=Date.now(),r=await this.controller.startScreenStream({fps:this.targetFps},(r,s)=>{this.streaming&&(e++,1===e&&this.logger.info(`First frame received in ${Date.now()-t}ms`),this.panel.webview.postMessage({type:"frame",data:r,mimeType:s,timestamp:Date.now()}))});if(!r)return this.logger.warn("Screen streaming failed to start"),void(this.streaming=!1);this.streamHandle=r,this.logger.info("Screen streaming started successfully")}stopStreaming(){this.streaming=!1,this.streamHandle&&(this.streamHandle.stop(),this.streamHandle=null),this.logger.info("Stopped Android Emulator streaming")}getHtmlContent(){const e=this.getNonce(),t=this.panel.webview.asWebviewUri(o.Uri.joinPath(this.extensionUri,"media","emulatorView.js")),r=this.panel.webview.asWebviewUri(o.Uri.joinPath(this.extensionUri,"media","emulatorView.css")),s=this.panel.webview.cspSource;return`<!DOCTYPE html>\n<html lang="en">\n<head>\n\t<meta charset="UTF-8">\n\t<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">\n\t<meta http-equiv="Content-Security-Policy" content="\n\t\tdefault-src 'none';\n\t\timg-src ${s} data:;\n\t\tscript-src 'nonce-${e}';\n\t\tstyle-src ${s} 'unsafe-inline';\n\t">\n\t<link rel="stylesheet" href="${r}">\n\t<title>Android Emulator</title>\n</head>\n<body>\n\t<div class="emulator-wrapper" id="emulator-wrapper">\n\t\t<canvas id="emulator-canvas"></canvas>\n\t\t<div class="loading" id="loading">\n\t\t\t<div class="spinner"></div>\n\t\t\t<span>Waiting for emulator...</span>\n\t\t</div>\n\t</div>\n\t<div class="controls-bar">\n\t\t<button id="home-btn" class="control-btn" title="Home">\n\t\t\t<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n\t\t\t\t<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>\n\t\t\t\t<polyline points="9 22 9 12 15 12 15 22"></polyline>\n\t\t\t</svg>\n\t\t</button>\n\t\t<button id="back-btn" class="control-btn" title="Back">\n\t\t\t<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n\t\t\t\t<polyline points="15 18 9 12 15 6"></polyline>\n\t\t\t</svg>\n\t\t</button>\n\t\t<button id="recents-btn" class="control-btn" title="Recent Apps">\n\t\t\t<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n\t\t\t\t<rect x="3" y="3" width="7" height="7"></rect>\n\t\t\t\t<rect x="14" y="3" width="7" height="7"></rect>\n\t\t\t\t<rect x="14" y="14" width="7" height="7"></rect>\n\t\t\t\t<rect x="3" y="14" width="7" height="7"></rect>\n\t\t\t</svg>\n\t\t</button>\n\t</div>\n\t<script nonce="${e}" src="${t}"><\/script>\n</body>\n</html>`}getNonce(){let e="";for(let t=0;t<32;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e}}t.EmulatorWebviewPanel=d,d.viewType="cursor.androidEmulator.dockedView"},614:function(e,t,r){var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return n(t,e),t},i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.z=void 0;const o=a(r(555));t.z=o,i(r(555),t),t.default=o},627:function(e,t,r){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMap=t.setErrorMap=t.defaultErrorMap=void 0;const n=s(r(227));t.defaultErrorMap=n.default;let a=n.default;t.setErrorMap=function(e){a=e},t.getErrorMap=function(){return a}},641:function(e,t,r){var s,n=this&&this.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(s=function(e){return s=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},s(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=s(e),i=0;i<r.length;i++)"default"!==r[i]&&n(t,e,r[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.AdbManager=void 0;const o=i(r(317)),d=i(r(943)),c=i(r(928)),u=r(23),l=r(65),p=(0,u.promisify)(o.execFile);t.AdbManager=class{constructor(e,t){this.logger=e,this.globalStoragePath=t,this.status="not_installed",this.adbPath=null,this.currentDeviceSerial=null,this.emulatorConsole=new l.EmulatorConsole(e)}getStatus(){return this.status}getAdbPath(){return this.adbPath}async ensureInstalled(){if("ready"===this.status&&this.adbPath)return!0;const e=await this.findSystemAdb();return e?(this.adbPath=e,this.status="ready",!0):(this.status="error",this.logger.error("ADB not found. Please install Android SDK or Android Studio."),!1)}async findSystemAdb(){const e=[];if("win32"===process.platform){const t=process.env.LOCALAPPDATA||"",r=process.env.USERPROFILE||"";e.push(c.join(t,"Android","Sdk","platform-tools","adb.exe"),c.join(r,"AppData","Local","Android","Sdk","platform-tools","adb.exe"),"C:\\Android\\sdk\\platform-tools\\adb.exe")}else if("darwin"===process.platform){const t=process.env.HOME||"";e.push(c.join(t,"Library","Android","sdk","platform-tools","adb"),"/opt/homebrew/bin/adb","/usr/local/bin/adb")}else{const t=process.env.HOME||"";e.push(c.join(t,"Android","Sdk","platform-tools","adb"),"/usr/bin/adb","/usr/local/bin/adb")}const t=process.env.ANDROID_HOME||process.env.ANDROID_SDK_ROOT;if(t){const r=c.join(t,"platform-tools","win32"===process.platform?"adb.exe":"adb");e.unshift(r)}for(const t of e)if(await this.fileExists(t))return t;try{const e="win32"===process.platform?"where":"which",{stdout:t}=await p(e,["adb"]),r=t.trim().split(/\r?\n/)[0]?.trim();if(r&&await this.fileExists(r))return r}catch{}return null}async fileExists(e){try{return await d.access(e),!0}catch{return!1}}async runAdbCommand(e,t){if(!this.adbPath)throw new Error("ADB not installed");const r=t?["-s",t,...e]:e;try{const e=await p(this.adbPath,r,{timeout:3e4});return{stdout:e.stdout?.toString()??"",stderr:e.stderr?.toString()??""}}catch(t){const r=e[0]??"unknown";throw this.logger.error(`ADB command failed: ${r}`,t),t}}async listDevices(){try{await this.ensureInstalled();const{stdout:e}=await this.runAdbCommand(["devices","-l"]),t=e.trim().split("\n"),r=[];for(let e=1;e<t.length;e++){const s=t[e].trim();if(!s)continue;const n=s.split(/\s+/);if(n.length>=2){const e={serial:n[0],state:n[1]};for(let t=2;t<n.length;t++){const r=n[t];r.startsWith("product:")?e.product=r.substring(8):r.startsWith("model:")?e.model=r.substring(6):r.startsWith("device:")?e.device=r.substring(7):r.startsWith("transport_id:")&&(e.transportId=r.substring(13))}r.push(e)}}return r}catch(e){return this.logger.error("Failed to list devices",e),[]}}async getConnectedDeviceSerial(){const e=(await this.listDevices()).filter(e=>"device"===e.state);if(0===e.length)return null;const t=e.find(e=>e.serial.startsWith("emulator-"));return t?.serial??e[0].serial}async tap(e,t,r=0,s){try{await this.ensureInstalled();const n=s||await this.getConnectedDeviceSerial();return n?n.startsWith("emulator-")&&0===r&&await this.emulatorConsole.tap(e,t)?{success:!0,x:e,y:t,method:"console"}:(r>0?await this.runAdbCommand(["shell","input","swipe",String(Math.round(e)),String(Math.round(t)),String(Math.round(e)),String(Math.round(t)),String(r)],n):await this.runAdbCommand(["shell","input","tap",String(Math.round(e)),String(Math.round(t))],n),{success:!0,x:e,y:t,method:"adb"}):{success:!1,error:"No connected device found"}}catch(r){return this.logger.error("Tap failed",r),{success:!1,x:e,y:t,error:String(r)}}}async swipe(e,t,r,s,n=300,a){try{await this.ensureInstalled();const i=a||await this.getConnectedDeviceSerial();return i?i.startsWith("emulator-")&&await this.emulatorConsole.swipe({startX:e,startY:t,endX:r,endY:s,durationMs:n})?{success:!0,startX:e,startY:t,endX:r,endY:s,method:"console"}:(await this.runAdbCommand(["shell","input","swipe",String(Math.round(e)),String(Math.round(t)),String(Math.round(r)),String(Math.round(s)),String(n)],i),{success:!0,startX:e,startY:t,endX:r,endY:s,method:"adb"}):{success:!1,error:"No connected device found"}}catch(n){return this.logger.error("Swipe failed",n),{success:!1,startX:e,startY:t,endX:r,endY:s,error:String(n)}}}async typeText(e,t){try{await this.ensureInstalled();const r=t||await this.getConnectedDeviceSerial();if(!r)return{success:!1,error:"No connected device found"};const s=e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/'/g,"\\'").replace(/ /g,"%s").replace(/&/g,"\\&").replace(/</g,"\\<").replace(/>/g,"\\>").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\|/g,"\\|").replace(/;/g,"\\;").replace(/\$/g,"\\$").replace(/`/g,"\\`");return await this.runAdbCommand(["shell","input","text",s],r),{success:!0,text:e,method:"adb"}}catch(t){return this.logger.error("Type failed",t),{success:!1,text:e,error:String(t)}}}async pressKey(e,t){try{await this.ensureInstalled();const r=t||await this.getConnectedDeviceSerial();if(!r)return{success:!1,error:"No connected device found"};const s={enter:66,return:66,tab:61,space:62,backspace:67,delete:112,escape:111,up:19,down:20,left:21,right:22,home:3,back:4,menu:82,search:84,volume_up:24,volume_down:25,power:26,camera:27,app_switch:187}[e.toLowerCase()];if(s)return await this.runAdbCommand(["shell","input","keyevent",String(s)],r),{success:!0,key:e,method:"adb"};if(1===e.length){const r=await this.typeText(e,t);return{success:r.success,key:e,method:r.method,error:r.error}}return{success:!1,key:e,error:"Unknown key"}}catch(t){return this.logger.error("Key press failed",t),{success:!1,key:e,error:String(t)}}}async getAccessibilityTree(e=10,t=50,r){try{await this.ensureInstalled();const s=r||await this.getConnectedDeviceSerial();if(!s)return{error:"No connected device found"};const n="/sdcard/window_dump.xml";await this.runAdbCommand(["shell","uiautomator","dump",n],s);const{stdout:a}=await this.runAdbCommand(["shell","cat",n],s),i=this.parseUiAutomatorXml(a,e,t);return await this.runAdbCommand(["shell","rm",n],s).catch(()=>{}),{capturedAt:(new Date).toISOString(),tree:i}}catch(e){return this.logger.error("Accessibility snapshot failed",e),{error:String(e)}}}parseUiAutomatorXml(e,t,r){const s=e.match(/<hierarchy[^>]*>([\s\S]*)<\/hierarchy>/),n=s?s[1].trim():e.trim();if(!n)return null;const a=this.tokenizeXml(n);if(0===a.length)return null;let i=0;const o=()=>{if(i>=a.length)return;const e=a[i];if("self-closing"!==e.type){if("open"===e.type)for(i++;i<a.length;){if("close"===a[i].type)return void i++;o()}}else i++},d=e=>{if(i>=a.length)return null;const s=a[i];if("open"!==s.type&&"self-closing"!==s.type)return null;if(e>t)return o(),null;i++;const n=this.createNodeFromAttrs(s.attrs);if("self-closing"===s.type)return n;const c=[];for(;i<a.length;){const t=a[i];if("close"===t.type){i++;break}if("open"===t.type||"self-closing"===t.type)if(c.length>=r)o();else{const t=d(e+1);t&&c.push(t)}else i++}return c.length>0&&(n.children=c),n};return d(0)}tokenizeXml(e){const t=[],r=/<(\/?)node\s*([^>]*?)(\/?)>/g;let s;for(;null!==(s=r.exec(e));){const e="/"===s[1],r=s[2],n="/"===s[3];e?t.push({type:"close",attrs:{}}):n?t.push({type:"self-closing",attrs:this.parseAttributes(r)}):t.push({type:"open",attrs:this.parseAttributes(r)})}return t}parseAttributes(e){const t={},r=/(\w+(?:-\w+)*)="([^"]*)"/g;let s;for(;null!==(s=r.exec(e));)t[s[1]]=s[2];return t}createNodeFromAttrs(e){let t=null;if(e.bounds){const r=e.bounds.match(/\[(\d+),(\d+)\]\[(\d+),(\d+)\]/);if(r){const e=parseInt(r[1],10),s=parseInt(r[2],10);t={x:e,y:s,width:parseInt(r[3],10)-e,height:parseInt(r[4],10)-s}}}return{class:e.class||null,text:e.text||null,"resource-id":e["resource-id"]||null,"content-desc":e["content-desc"]||null,package:e.package||null,checkable:"true"===e.checkable,checked:"true"===e.checked,clickable:"true"===e.clickable,enabled:"true"===e.enabled,focusable:"true"===e.focusable,focused:"true"===e.focused,scrollable:"true"===e.scrollable,"long-clickable":"true"===e["long-clickable"],selected:"true"===e.selected,frame:t}}async captureScreenshot(e){try{await this.ensureInstalled();const t=e||await this.getConnectedDeviceSerial();if(!t)return null;const{stdout:r}=await p(this.adbPath,["-s",t,"exec-out","screencap","-p"],{encoding:"buffer",maxBuffer:52428800,timeout:5e3});return{base64Data:r.toString("base64"),mimeType:"image/png"}}catch(e){return this.logger.error("Screenshot capture failed",e),null}}async captureScreenshotJpeg(e=60,t){try{await this.ensureInstalled();const e=t||await this.getConnectedDeviceSerial();if(!e)return null;try{const{stdout:t}=await p(this.adbPath,["-s",e,"exec-out","screencap -p | toybox base64"],{encoding:"buffer",maxBuffer:52428800,timeout:2e3,shell:!0});return{base64Data:t.toString("utf8").trim(),mimeType:"image/png"}}catch{}const{stdout:r}=await p(this.adbPath,["-s",e,"exec-out","screencap","-p"],{encoding:"buffer",maxBuffer:52428800,timeout:3e3});return{base64Data:r.toString("base64"),mimeType:"image/png"}}catch(e){return this.logger.error("JPEG screenshot capture failed",e),null}}async launchApp(e,t,r){try{await this.ensureInstalled();const s=r||await this.getConnectedDeviceSerial();return s?(t?await this.runAdbCommand(["shell","am","start","-n",`${e}/${t}`],s):await this.runAdbCommand(["shell","monkey","-p",e,"-c","android.intent.category.LAUNCHER","1"],s),{success:!0}):{success:!1,error:"No connected device found"}}catch(e){return this.logger.error("Launch app failed",e),{success:!1,error:String(e)}}}async waitForIdle(e=5e3,t){try{await this.ensureInstalled();const r=t||await this.getConnectedDeviceSerial();if(!r)return{success:!1,error:"No connected device found"};const s=Date.now(),n=500;for(;Date.now()-s<e;){const{stdout:e}=await this.runAdbCommand(["shell","dumpsys","window","animator"],r);if(!e.includes("mRunning=true")&&!e.includes("mAnimating=true"))return await this.sleep(100),{success:!0};await this.sleep(n)}return{success:!1,error:"Timeout waiting for UI to become idle"}}catch(e){return this.logger.error("Wait for idle failed",e),{success:!1,error:String(e)}}}async listAvailableEmulators(){try{const e=await this.findEmulatorBinary();if(!e)return{emulators:[],error:"Android emulator not found. Please install Android Studio or SDK."};const{stdout:t}=await p(e,["-list-avds"],{timeout:1e4});return{emulators:t.trim().split("\n").filter(e=>e.trim().length>0)}}catch(e){return this.logger.error("List emulators failed",e),{emulators:[],error:String(e)}}}async startEmulator(e){try{const t=await this.findEmulatorBinary();if(!t)return{success:!1,error:"Android emulator not found. Please install Android Studio or SDK."};const r=o.spawn(t,["-avd",e,"-no-snapshot-load"],{detached:!0,stdio:"ignore"});return r.on("error",e=>{this.logger.error("Emulator spawn error",e)}),r.unref(),await this.sleep(2e3),{success:!0}}catch(e){return this.logger.error("Start emulator failed",e),{success:!1,error:String(e)}}}async waitForBoot(e=12e4){try{await this.ensureInstalled();const t=Date.now(),r=2e3;for(;Date.now()-t<e;){const e=(await this.listDevices()).filter(e=>"device"===e.state&&e.serial.startsWith("emulator-"));if(e.length>0)try{const{stdout:t}=await this.runAdbCommand(["shell","getprop","sys.boot_completed"],e[0].serial);if("1"===t.trim())return await this.sleep(2e3),{success:!0}}catch{}await this.sleep(r)}return{success:!1,error:`Timeout waiting for emulator to boot after ${e}ms`}}catch(e){return this.logger.error("Wait for boot failed",e),{success:!1,error:String(e)}}}async findEmulatorBinary(){const e=[];if("win32"===process.platform){const t=process.env.LOCALAPPDATA||"",r=process.env.USERPROFILE||"";e.push(c.join(t,"Android","Sdk","emulator","emulator.exe"),c.join(r,"AppData","Local","Android","Sdk","emulator","emulator.exe"))}else if("darwin"===process.platform){const t=process.env.HOME||"";e.push(c.join(t,"Library","Android","sdk","emulator","emulator"),"/opt/homebrew/bin/emulator")}else{const t=process.env.HOME||"";e.push(c.join(t,"Android","Sdk","emulator","emulator"))}const t=process.env.ANDROID_HOME||process.env.ANDROID_SDK_ROOT;if(t){const r=c.join(t,"emulator","win32"===process.platform?"emulator.exe":"emulator");e.unshift(r)}for(const t of e)if(await this.fileExists(t))return t;return null}sleep(e){return new Promise(t=>setTimeout(t,e))}async dispose(){this.emulatorConsole.dispose(),this.currentDeviceSerial=null}}},739:function(e,t,r){var s,n,a=this&&this.__classPrivateFieldGet||function(e,t,r,s){if("a"===r&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)},i=this&&this.__classPrivateFieldSet||function(e,t,r,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=t.bigint=t.array=t.any=t.coerce=t.ZodFirstPartyTypeKind=t.late=t.ZodSchema=t.Schema=t.custom=t.ZodReadonly=t.ZodPipeline=t.ZodBranded=t.BRAND=t.ZodNaN=t.ZodCatch=t.ZodDefault=t.ZodNullable=t.ZodOptional=t.ZodTransformer=t.ZodEffects=t.ZodPromise=t.ZodNativeEnum=t.ZodEnum=t.ZodLiteral=t.ZodLazy=t.ZodFunction=t.ZodSet=t.ZodMap=t.ZodRecord=t.ZodTuple=t.ZodIntersection=t.ZodDiscriminatedUnion=t.ZodUnion=t.ZodObject=t.ZodArray=t.ZodVoid=t.ZodNever=t.ZodUnknown=t.ZodAny=t.ZodNull=t.ZodUndefined=t.ZodSymbol=t.ZodDate=t.ZodBoolean=t.ZodBigInt=t.ZodNumber=t.ZodString=t.datetimeRegex=t.ZodType=void 0,t.NEVER=t.void=t.unknown=t.union=t.undefined=t.tuple=t.transformer=t.symbol=t.string=t.strictObject=t.set=t.record=t.promise=t.preprocess=t.pipeline=t.ostring=t.optional=t.onumber=t.oboolean=t.object=t.number=t.nullable=t.null=t.never=t.nativeEnum=t.nan=t.map=t.literal=t.lazy=t.intersection=t.instanceof=t.function=t.enum=t.effect=t.discriminatedUnion=t.date=void 0;const o=r(627),d=r(750),c=r(231),u=r(146),l=r(837);class p{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const h=(e,t)=>{if((0,c.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new l.ZodError(e.common.issues);return this._error=t,this._error}}};function m(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:s,description:n}=e;if(t&&(r||s))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{var a,i;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:n.defaultError}:void 0===n.data?{message:null!==(a=null!=o?o:s)&&void 0!==a?a:n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:null!==(i=null!=o?o:r)&&void 0!==i?i:n.defaultError}},description:n}}class f{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,u.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,u.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new c.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,u.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if((0,c.isAsync)(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const s={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,u.getParsedType)(e)},n=this._parseSync({data:e,path:s.path,parent:s});return h(s,n)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,u.getParsedType)(e)},s=this._parse({data:e,path:r.path,parent:r}),n=await((0,c.isAsync)(s)?s:Promise.resolve(s));return h(r,n)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,s)=>{const n=e(t),a=()=>s.addIssue({code:l.ZodIssueCode.custom,...r(t)});return"undefined"!=typeof Promise&&n instanceof Promise?n.then(e=>!!e||(a(),!1)):!!n||(a(),!1)})}refinement(e,t){return this._refinement((r,s)=>!!e(r)||(s.addIssue("function"==typeof t?t(r,s):t),!1))}_refinement(e){return new le({schema:this,typeName:we.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return pe.create(this,this._def)}nullable(){return he.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return W.create(this,this._def)}promise(){return ue.create(this,this._def)}or(e){return q.create([this,e],this._def)}and(e){return Q.create(this,e,this._def)}transform(e){return new le({...m(this._def),schema:this,typeName:we.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new me({...m(this._def),innerType:this,defaultValue:t,typeName:we.ZodDefault})}brand(){return new ye({typeName:we.ZodBranded,type:this,...m(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new fe({...m(this._def),innerType:this,catchValue:t,typeName:we.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ve.create(this,e)}readonly(){return _e.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}t.ZodType=f,t.Schema=f,t.ZodSchema=f;const g=/^c[^\s-]{8,}$/i,y=/^[0-9a-z]+$/,v=/^[0-9A-HJKMNP-TV-Z]{26}$/,_=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,b=/^[a-z0-9_-]{21}$/i,w=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,x=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let k;const Z=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,P=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,T=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,I="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",C=new RegExp(`^${I}$`);function S(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function A(e){return new RegExp(`^${S(e)}$`)}function O(e){let t=`${I}T${S(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function D(e,t){return!("v4"!==t&&t||!Z.test(e))||!("v6"!==t&&t||!P.test(e))}t.datetimeRegex=O;class M extends f{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==u.ZodParsedType.string){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.string,received:t.parsedType}),c.INVALID}const t=new c.ParseStatus;let r;for(const s of this._def.checks)if("min"===s.kind)e.data.length<s.value&&(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),t.dirty());else if("max"===s.kind)e.data.length>s.value&&(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),t.dirty());else if("length"===s.kind){const n=e.data.length>s.value,a=e.data.length<s.value;(n||a)&&(r=this._getOrReturnCtx(e,r),n?(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),t.dirty())}else if("email"===s.kind)x.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"email",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty());else if("emoji"===s.kind)k||(k=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),k.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"emoji",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty());else if("uuid"===s.kind)_.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"uuid",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty());else if("nanoid"===s.kind)b.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"nanoid",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty());else if("cuid"===s.kind)g.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"cuid",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty());else if("cuid2"===s.kind)y.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"cuid2",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty());else if("ulid"===s.kind)v.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"ulid",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty());else if("url"===s.kind)try{new URL(e.data)}catch(n){r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"url",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty()}else"regex"===s.kind?(s.regex.lastIndex=0,s.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"regex",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty())):"trim"===s.kind?e.data=e.data.trim():"includes"===s.kind?e.data.includes(s.value,s.position)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),t.dirty()):"toLowerCase"===s.kind?e.data=e.data.toLowerCase():"toUpperCase"===s.kind?e.data=e.data.toUpperCase():"startsWith"===s.kind?e.data.startsWith(s.value)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_string,validation:{startsWith:s.value},message:s.message}),t.dirty()):"endsWith"===s.kind?e.data.endsWith(s.value)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_string,validation:{endsWith:s.value},message:s.message}),t.dirty()):"datetime"===s.kind?O(s).test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_string,validation:"datetime",message:s.message}),t.dirty()):"date"===s.kind?C.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_string,validation:"date",message:s.message}),t.dirty()):"time"===s.kind?A(s).test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_string,validation:"time",message:s.message}),t.dirty()):"duration"===s.kind?w.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"duration",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty()):"ip"===s.kind?D(e.data,s.version)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"ip",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty()):"base64"===s.kind?T.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{validation:"base64",code:l.ZodIssueCode.invalid_string,message:s.message}),t.dirty()):u.util.assertNever(s);return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:l.ZodIssueCode.invalid_string,...d.errorUtil.errToObj(r)})}_addCheck(e){return new M({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...d.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...d.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...d.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...d.errorUtil.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...d.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...d.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...d.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...d.errorUtil.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...d.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...d.errorUtil.errToObj(e)})}datetime(e){var t,r;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(r=null==e?void 0:e.local)&&void 0!==r&&r,...d.errorUtil.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...d.errorUtil.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...d.errorUtil.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...d.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...d.errorUtil.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...d.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...d.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...d.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...d.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...d.errorUtil.errToObj(t)})}nonempty(e){return this.min(1,d.errorUtil.errToObj(e))}trim(){return new M({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new M({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new M({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function E(e,t){const r=(e.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,n=r>s?r:s;return parseInt(e.toFixed(n).replace(".",""))%parseInt(t.toFixed(n).replace(".",""))/Math.pow(10,n)}t.ZodString=M,M.create=e=>{var t;return new M({checks:[],typeName:we.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...m(e)})};class N extends f{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==u.ZodParsedType.number){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.number,received:t.parsedType}),c.INVALID}let t;const r=new c.ParseStatus;for(const s of this._def.checks)"int"===s.kind?u.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty()):"min"===s.kind?(s.inclusive?e.data<s.value:e.data<=s.value)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):"max"===s.kind?(s.inclusive?e.data>s.value:e.data>=s.value)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):"multipleOf"===s.kind?0!==E(e.data,s.value)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):"finite"===s.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.not_finite,message:s.message}),r.dirty()):u.util.assertNever(s);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,d.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,d.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,d.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,d.errorUtil.toString(t))}setLimit(e,t,r,s){return new N({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:d.errorUtil.toString(s)}]})}_addCheck(e){return new N({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:d.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:d.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:d.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:d.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:d.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:d.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:d.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:d.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:d.errorUtil.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&u.util.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}t.ZodNumber=N,N.create=e=>new N({checks:[],typeName:we.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...m(e)});class j extends f{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==u.ZodParsedType.bigint){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.bigint,received:t.parsedType}),c.INVALID}let t;const r=new c.ParseStatus;for(const s of this._def.checks)"min"===s.kind?(s.inclusive?e.data<s.value:e.data<=s.value)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):"max"===s.kind?(s.inclusive?e.data>s.value:e.data>=s.value)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):"multipleOf"===s.kind?e.data%s.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):u.util.assertNever(s);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,d.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,d.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,d.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,d.errorUtil.toString(t))}setLimit(e,t,r,s){return new j({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:d.errorUtil.toString(s)}]})}_addCheck(e){return new j({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:d.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:d.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:d.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:d.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:d.errorUtil.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodBigInt=j,j.create=e=>{var t;return new j({checks:[],typeName:we.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...m(e)})};class $ extends f{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==u.ZodParsedType.boolean){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.boolean,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}t.ZodBoolean=$,$.create=e=>new $({typeName:we.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...m(e)});class U extends f{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==u.ZodParsedType.date){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.date,received:t.parsedType}),c.INVALID}if(isNaN(e.data.getTime())){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_date}),c.INVALID}const t=new c.ParseStatus;let r;for(const s of this._def.checks)"min"===s.kind?e.data.getTime()<s.value&&(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),t.dirty()):"max"===s.kind?e.data.getTime()>s.value&&(r=this._getOrReturnCtx(e,r),(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),t.dirty()):u.util.assertNever(s);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new U({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:d.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:d.errorUtil.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}t.ZodDate=U,U.create=e=>new U({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:we.ZodDate,...m(e)});class L extends f{_parse(e){if(this._getType(e)!==u.ZodParsedType.symbol){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.symbol,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}t.ZodSymbol=L,L.create=e=>new L({typeName:we.ZodSymbol,...m(e)});class R extends f{_parse(e){if(this._getType(e)!==u.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.undefined,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}t.ZodUndefined=R,R.create=e=>new R({typeName:we.ZodUndefined,...m(e)});class V extends f{_parse(e){if(this._getType(e)!==u.ZodParsedType.null){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.null,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}t.ZodNull=V,V.create=e=>new V({typeName:we.ZodNull,...m(e)});class z extends f{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,c.OK)(e.data)}}t.ZodAny=z,z.create=e=>new z({typeName:we.ZodAny,...m(e)});class F extends f{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,c.OK)(e.data)}}t.ZodUnknown=F,F.create=e=>new F({typeName:we.ZodUnknown,...m(e)});class K extends f{_parse(e){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.never,received:t.parsedType}),c.INVALID}}t.ZodNever=K,K.create=e=>new K({typeName:we.ZodNever,...m(e)});class B extends f{_parse(e){if(this._getType(e)!==u.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.void,received:t.parsedType}),c.INVALID}return(0,c.OK)(e.data)}}t.ZodVoid=B,B.create=e=>new B({typeName:we.ZodVoid,...m(e)});class W extends f{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==u.ZodParsedType.array)return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.array,received:t.parsedType}),c.INVALID;if(null!==s.exactLength){const e=t.data.length>s.exactLength.value,n=t.data.length<s.exactLength.value;(e||n)&&((0,c.addIssueToContext)(t,{code:e?l.ZodIssueCode.too_big:l.ZodIssueCode.too_small,minimum:n?s.exactLength.value:void 0,maximum:e?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(null!==s.minLength&&t.data.length<s.minLength.value&&((0,c.addIssueToContext)(t,{code:l.ZodIssueCode.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),null!==s.maxLength&&t.data.length>s.maxLength.value&&((0,c.addIssueToContext)(t,{code:l.ZodIssueCode.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>s.type._parseAsync(new p(t,e,t.path,r)))).then(e=>c.ParseStatus.mergeArray(r,e));const n=[...t.data].map((e,r)=>s.type._parseSync(new p(t,e,t.path,r)));return c.ParseStatus.mergeArray(r,n)}get element(){return this._def.type}min(e,t){return new W({...this._def,minLength:{value:e,message:d.errorUtil.toString(t)}})}max(e,t){return new W({...this._def,maxLength:{value:e,message:d.errorUtil.toString(t)}})}length(e,t){return new W({...this._def,exactLength:{value:e,message:d.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}function Y(e){if(e instanceof X){const t={};for(const r in e.shape){const s=e.shape[r];t[r]=pe.create(Y(s))}return new X({...e._def,shape:()=>t})}return e instanceof W?new W({...e._def,type:Y(e.element)}):e instanceof pe?pe.create(Y(e.unwrap())):e instanceof he?he.create(Y(e.unwrap())):e instanceof ee?ee.create(e.items.map(e=>Y(e))):e}t.ZodArray=W,W.create=(e,t)=>new W({type:e,minLength:null,maxLength:null,exactLength:null,typeName:we.ZodArray,...m(t)});class X extends f{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=u.util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==u.ZodParsedType.object){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.object,received:t.parsedType}),c.INVALID}const{status:t,ctx:r}=this._processInputParams(e),{shape:s,keys:n}=this._getCached(),a=[];if(!(this._def.catchall instanceof K&&"strip"===this._def.unknownKeys))for(const e in r.data)n.includes(e)||a.push(e);const i=[];for(const e of n){const t=s[e],n=r.data[e];i.push({key:{status:"valid",value:e},value:t._parse(new p(r,n,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof K){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of a)i.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)a.length>0&&((0,c.addIssueToContext)(r,{code:l.ZodIssueCode.unrecognized_keys,keys:a}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of a){const s=r.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new p(r,s,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const e=[];for(const t of i){const r=await t.key,s=await t.value;e.push({key:r,value:s,alwaysSet:t.alwaysSet})}return e}).then(e=>c.ParseStatus.mergeObjectSync(t,e)):c.ParseStatus.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return d.errorUtil.errToObj,new X({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var s,n,a,i;const o=null!==(a=null===(n=(s=this._def).errorMap)||void 0===n?void 0:n.call(s,t,r).message)&&void 0!==a?a:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(i=d.errorUtil.errToObj(e).message)&&void 0!==i?i:o}:{message:o}}}:{}})}strip(){return new X({...this._def,unknownKeys:"strip"})}passthrough(){return new X({...this._def,unknownKeys:"passthrough"})}extend(e){return new X({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new X({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:we.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new X({...this._def,catchall:e})}pick(e){const t={};return u.util.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new X({...this._def,shape:()=>t})}omit(e){const t={};return u.util.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new X({...this._def,shape:()=>t})}deepPartial(){return Y(this)}partial(e){const t={};return u.util.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}),new X({...this._def,shape:()=>t})}required(e){const t={};return u.util.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof pe;)e=e._def.innerType;t[r]=e}}),new X({...this._def,shape:()=>t})}keyof(){return oe(u.util.objectKeys(this.shape))}}t.ZodObject=X,X.create=(e,t)=>new X({shape:()=>e,unknownKeys:"strip",catchall:K.create(),typeName:we.ZodObject,...m(t)}),X.strictCreate=(e,t)=>new X({shape:()=>e,unknownKeys:"strict",catchall:K.create(),typeName:we.ZodObject,...m(t)}),X.lazycreate=(e,t)=>new X({shape:e,unknownKeys:"strip",catchall:K.create(),typeName:we.ZodObject,...m(t)});class q extends f{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map(e=>new l.ZodError(e.ctx.common.issues));return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_union,unionErrors:r}),c.INVALID});{let e;const s=[];for(const n of r){const r={...t,common:{...t.common,issues:[]},parent:null},a=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:r}),r.common.issues.length&&s.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const n=s.map(e=>new l.ZodError(e));return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_union,unionErrors:n}),c.INVALID}}get options(){return this._def.options}}t.ZodUnion=q,q.create=(e,t)=>new q({options:e,typeName:we.ZodUnion,...m(t)});const H=e=>e instanceof ae?H(e.schema):e instanceof le?H(e.innerType()):e instanceof ie?[e.value]:e instanceof de?e.options:e instanceof ce?u.util.objectValues(e.enum):e instanceof me?H(e._def.innerType):e instanceof R?[void 0]:e instanceof V?[null]:e instanceof pe?[void 0,...H(e.unwrap())]:e instanceof he?[null,...H(e.unwrap())]:e instanceof ye||e instanceof _e?H(e.unwrap()):e instanceof fe?H(e._def.innerType):[];class J extends f{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==u.ZodParsedType.object)return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.object,received:t.parsedType}),c.INVALID;const r=this.discriminator,s=t.data[r],n=this.optionsMap.get(s);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):((0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),c.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const s=new Map;for(const r of t){const t=H(r.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const n of t){if(s.has(n))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(n)}`);s.set(n,r)}}return new J({typeName:we.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...m(r)})}}function G(e,t){const r=(0,u.getParsedType)(e),s=(0,u.getParsedType)(t);if(e===t)return{valid:!0,data:e};if(r===u.ZodParsedType.object&&s===u.ZodParsedType.object){const r=u.util.objectKeys(t),s=u.util.objectKeys(e).filter(e=>-1!==r.indexOf(e)),n={...e,...t};for(const r of s){const s=G(e[r],t[r]);if(!s.valid)return{valid:!1};n[r]=s.data}return{valid:!0,data:n}}if(r===u.ZodParsedType.array&&s===u.ZodParsedType.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let s=0;s<e.length;s++){const n=G(e[s],t[s]);if(!n.valid)return{valid:!1};r.push(n.data)}return{valid:!0,data:r}}return r===u.ZodParsedType.date&&s===u.ZodParsedType.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}t.ZodDiscriminatedUnion=J;class Q extends f{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(e,s)=>{if((0,c.isAborted)(e)||(0,c.isAborted)(s))return c.INVALID;const n=G(e.value,s.value);return n.valid?(((0,c.isDirty)(e)||(0,c.isDirty)(s))&&t.dirty(),{status:t.value,value:n.data}):((0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_intersection_types}),c.INVALID)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>s(e,t)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}t.ZodIntersection=Q,Q.create=(e,t,r)=>new Q({left:e,right:t,typeName:we.ZodIntersection,...m(r)});class ee extends f{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.array)return(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.array,received:r.parsedType}),c.INVALID;if(r.data.length<this._def.items.length)return(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.INVALID;!this._def.rest&&r.data.length>this._def.items.length&&((0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...r.data].map((e,t)=>{const s=this._def.items[t]||this._def.rest;return s?s._parse(new p(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(s).then(e=>c.ParseStatus.mergeArray(t,e)):c.ParseStatus.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new ee({...this._def,rest:e})}}t.ZodTuple=ee,ee.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ee({items:e,typeName:we.ZodTuple,rest:null,...m(t)})};class te extends f{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.object)return(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.object,received:r.parsedType}),c.INVALID;const s=[],n=this._def.keyType,a=this._def.valueType;for(const e in r.data)s.push({key:n._parse(new p(r,e,r.path,e)),value:a._parse(new p(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?c.ParseStatus.mergeObjectAsync(t,s):c.ParseStatus.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return new te(t instanceof f?{keyType:e,valueType:t,typeName:we.ZodRecord,...m(r)}:{keyType:M.create(),valueType:e,typeName:we.ZodRecord,...m(t)})}}t.ZodRecord=te;class re extends f{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.map)return(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.map,received:r.parsedType}),c.INVALID;const s=this._def.keyType,n=this._def.valueType,a=[...r.data.entries()].map(([e,t],a)=>({key:s._parse(new p(r,e,r.path,[a,"key"])),value:n._parse(new p(r,t,r.path,[a,"value"]))}));if(r.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const r of a){const s=await r.key,n=await r.value;if("aborted"===s.status||"aborted"===n.status)return c.INVALID;"dirty"!==s.status&&"dirty"!==n.status||t.dirty(),e.set(s.value,n.value)}return{status:t.value,value:e}})}{const e=new Map;for(const r of a){const s=r.key,n=r.value;if("aborted"===s.status||"aborted"===n.status)return c.INVALID;"dirty"!==s.status&&"dirty"!==n.status||t.dirty(),e.set(s.value,n.value)}return{status:t.value,value:e}}}}t.ZodMap=re,re.create=(e,t,r)=>new re({valueType:t,keyType:e,typeName:we.ZodMap,...m(r)});class se extends f{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==u.ZodParsedType.set)return(0,c.addIssueToContext)(r,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.set,received:r.parsedType}),c.INVALID;const s=this._def;null!==s.minSize&&r.data.size<s.minSize.value&&((0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),null!==s.maxSize&&r.data.size>s.maxSize.value&&((0,c.addIssueToContext)(r,{code:l.ZodIssueCode.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const n=this._def.valueType;function a(e){const r=new Set;for(const s of e){if("aborted"===s.status)return c.INVALID;"dirty"===s.status&&t.dirty(),r.add(s.value)}return{status:t.value,value:r}}const i=[...r.data.values()].map((e,t)=>n._parse(new p(r,e,r.path,t)));return r.common.async?Promise.all(i).then(e=>a(e)):a(i)}min(e,t){return new se({...this._def,minSize:{value:e,message:d.errorUtil.toString(t)}})}max(e,t){return new se({...this._def,maxSize:{value:e,message:d.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t.ZodSet=se,se.create=(e,t)=>new se({valueType:e,minSize:null,maxSize:null,typeName:we.ZodSet,...m(t)});class ne extends f{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==u.ZodParsedType.function)return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.function,received:t.parsedType}),c.INVALID;function r(e,r){return(0,c.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,o.getErrorMap)(),o.defaultErrorMap].filter(e=>!!e),issueData:{code:l.ZodIssueCode.invalid_arguments,argumentsError:r}})}function s(e,r){return(0,c.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,o.getErrorMap)(),o.defaultErrorMap].filter(e=>!!e),issueData:{code:l.ZodIssueCode.invalid_return_type,returnTypeError:r}})}const n={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof ue){const e=this;return(0,c.OK)(async function(...t){const i=new l.ZodError([]),o=await e._def.args.parseAsync(t,n).catch(e=>{throw i.addIssue(r(t,e)),i}),d=await Reflect.apply(a,this,o);return await e._def.returns._def.type.parseAsync(d,n).catch(e=>{throw i.addIssue(s(d,e)),i})})}{const e=this;return(0,c.OK)(function(...t){const i=e._def.args.safeParse(t,n);if(!i.success)throw new l.ZodError([r(t,i.error)]);const o=Reflect.apply(a,this,i.data),d=e._def.returns.safeParse(o,n);if(!d.success)throw new l.ZodError([s(o,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ne({...this._def,args:ee.create(e).rest(F.create())})}returns(e){return new ne({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new ne({args:e||ee.create([]).rest(F.create()),returns:t||F.create(),typeName:we.ZodFunction,...m(r)})}}t.ZodFunction=ne;class ae extends f{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t.ZodLazy=ae,ae.create=(e,t)=>new ae({getter:e,typeName:we.ZodLazy,...m(t)});class ie extends f{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{received:t.data,code:l.ZodIssueCode.invalid_literal,expected:this._def.value}),c.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function oe(e,t){return new de({values:e,typeName:we.ZodEnum,...m(t)})}t.ZodLiteral=ie,ie.create=(e,t)=>new ie({value:e,typeName:we.ZodLiteral,...m(t)});class de extends f{constructor(){super(...arguments),s.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return(0,c.addIssueToContext)(t,{expected:u.util.joinValues(r),received:t.parsedType,code:l.ZodIssueCode.invalid_type}),c.INVALID}if(a(this,s,"f")||i(this,s,new Set(this._def.values),"f"),!a(this,s,"f").has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return(0,c.addIssueToContext)(t,{received:t.data,code:l.ZodIssueCode.invalid_enum_value,options:r}),c.INVALID}return(0,c.OK)(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return de.create(e,{...this._def,...t})}exclude(e,t=this._def){return de.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}t.ZodEnum=de,s=new WeakMap,de.create=oe;class ce extends f{constructor(){super(...arguments),n.set(this,void 0)}_parse(e){const t=u.util.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==u.ZodParsedType.string&&r.parsedType!==u.ZodParsedType.number){const e=u.util.objectValues(t);return(0,c.addIssueToContext)(r,{expected:u.util.joinValues(e),received:r.parsedType,code:l.ZodIssueCode.invalid_type}),c.INVALID}if(a(this,n,"f")||i(this,n,new Set(u.util.getValidEnumValues(this._def.values)),"f"),!a(this,n,"f").has(e.data)){const e=u.util.objectValues(t);return(0,c.addIssueToContext)(r,{received:r.data,code:l.ZodIssueCode.invalid_enum_value,options:e}),c.INVALID}return(0,c.OK)(e.data)}get enum(){return this._def.values}}t.ZodNativeEnum=ce,n=new WeakMap,ce.create=(e,t)=>new ce({values:e,typeName:we.ZodNativeEnum,...m(t)});class ue extends f{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==u.ZodParsedType.promise&&!1===t.common.async)return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.promise,received:t.parsedType}),c.INVALID;const r=t.parsedType===u.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,c.OK)(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}t.ZodPromise=ue,ue.create=(e,t)=>new ue({type:e,typeName:we.ZodPromise,...m(t)});class le extends f{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===we.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,n={addIssue:e=>{(0,c.addIssueToContext)(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===s.type){const e=s.transform(r.data,n);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return c.INVALID;const s=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===s.status?c.INVALID:"dirty"===s.status||"dirty"===t.value?(0,c.DIRTY)(s.value):s});{if("aborted"===t.value)return c.INVALID;const s=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===s.status?c.INVALID:"dirty"===s.status||"dirty"===t.value?(0,c.DIRTY)(s.value):s}}if("refinement"===s.type){const e=e=>{const t=s.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===s.status?c.INVALID:("dirty"===s.status&&t.dirty(),e(s.value),{status:t.value,value:s.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?c.INVALID:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))))}if("transform"===s.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!(0,c.isValid)(e))return e;const a=s.transform(e.value,n);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>(0,c.isValid)(e)?Promise.resolve(s.transform(e.value,n)).then(e=>({status:t.value,value:e})):e)}u.util.assertNever(s)}}t.ZodEffects=le,t.ZodTransformer=le,le.create=(e,t,r)=>new le({schema:e,typeName:we.ZodEffects,effect:t,...m(r)}),le.createWithPreprocess=(e,t,r)=>new le({schema:t,effect:{type:"preprocess",transform:e},typeName:we.ZodEffects,...m(r)});class pe extends f{_parse(e){return this._getType(e)===u.ZodParsedType.undefined?(0,c.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodOptional=pe,pe.create=(e,t)=>new pe({innerType:e,typeName:we.ZodOptional,...m(t)});class he extends f{_parse(e){return this._getType(e)===u.ZodParsedType.null?(0,c.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodNullable=he,he.create=(e,t)=>new he({innerType:e,typeName:we.ZodNullable,...m(t)});class me extends f{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===u.ZodParsedType.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t.ZodDefault=me,me.create=(e,t)=>new me({innerType:e,typeName:we.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...m(t)});class fe extends f{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return(0,c.isAsync)(s)?s.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new l.ZodError(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===s.status?s.value:this._def.catchValue({get error(){return new l.ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}t.ZodCatch=fe,fe.create=(e,t)=>new fe({innerType:e,typeName:we.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...m(t)});class ge extends f{_parse(e){if(this._getType(e)!==u.ZodParsedType.nan){const t=this._getOrReturnCtx(e);return(0,c.addIssueToContext)(t,{code:l.ZodIssueCode.invalid_type,expected:u.ZodParsedType.nan,received:t.parsedType}),c.INVALID}return{status:"valid",value:e.data}}}t.ZodNaN=ge,ge.create=e=>new ge({typeName:we.ZodNaN,...m(e)}),t.BRAND=Symbol("zod_brand");class ye extends f{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}t.ZodBranded=ye;class ve extends f{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?c.INVALID:"dirty"===e.status?(t.dirty(),(0,c.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?c.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new ve({in:e,out:t,typeName:we.ZodPipeline})}}t.ZodPipeline=ve;class _e extends f{_parse(e){const t=this._def.innerType._parse(e),r=e=>((0,c.isValid)(e)&&(e.value=Object.freeze(e.value)),e);return(0,c.isAsync)(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}function be(e,t={},r){return e?z.create().superRefine((s,n)=>{var a,i;if(!e(s)){const e="function"==typeof t?t(s):"string"==typeof t?{message:t}:t,o=null===(i=null!==(a=e.fatal)&&void 0!==a?a:r)||void 0===i||i,d="string"==typeof e?{message:e}:e;n.addIssue({code:"custom",...d,fatal:o})}}):z.create()}var we;t.ZodReadonly=_e,_e.create=(e,t)=>new _e({innerType:e,typeName:we.ZodReadonly,...m(t)}),t.custom=be,t.late={object:X.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(we=t.ZodFirstPartyTypeKind||(t.ZodFirstPartyTypeKind={})),t.instanceof=(e,t={message:`Input not instance of ${e.name}`})=>be(t=>t instanceof e,t);const xe=M.create;t.string=xe;const ke=N.create;t.number=ke;const Ze=ge.create;t.nan=Ze;const Pe=j.create;t.bigint=Pe;const Te=$.create;t.boolean=Te;const Ie=U.create;t.date=Ie;const Ce=L.create;t.symbol=Ce;const Se=R.create;t.undefined=Se;const Ae=V.create;t.null=Ae;const Oe=z.create;t.any=Oe;const De=F.create;t.unknown=De;const Me=K.create;t.never=Me;const Ee=B.create;t.void=Ee;const Ne=W.create;t.array=Ne;const je=X.create;t.object=je;const $e=X.strictCreate;t.strictObject=$e;const Ue=q.create;t.union=Ue;const Le=J.create;t.discriminatedUnion=Le;const Re=Q.create;t.intersection=Re;const Ve=ee.create;t.tuple=Ve;const ze=te.create;t.record=ze;const Fe=re.create;t.map=Fe;const Ke=se.create;t.set=Ke;const Be=ne.create;t.function=Be;const We=ae.create;t.lazy=We;const Ye=ie.create;t.literal=Ye;const Xe=de.create;t.enum=Xe;const qe=ce.create;t.nativeEnum=qe;const He=ue.create;t.promise=He;const Je=le.create;t.effect=Je,t.transformer=Je;const Ge=pe.create;t.optional=Ge;const Qe=he.create;t.nullable=Qe;const et=le.createWithPreprocess;t.preprocess=et;const tt=ve.create;t.pipeline=tt,t.ostring=()=>xe().optional(),t.onumber=()=>ke().optional(),t.oboolean=()=>Te().optional(),t.coerce={string:e=>M.create({...e,coerce:!0}),number:e=>N.create({...e,coerce:!0}),boolean:e=>$.create({...e,coerce:!0}),bigint:e=>j.create({...e,coerce:!0}),date:e=>U.create({...e,coerce:!0})},t.NEVER=c.INVALID},750:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,(r=t.errorUtil||(t.errorUtil={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},r.toString=e=>"string"==typeof e?e:null==e?void 0:e.message},837:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ZodError=t.quotelessJson=t.ZodIssueCode=void 0;const s=r(146);t.ZodIssueCode=s.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),t.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class n extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},s=e=>{for(const n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(s);else if("invalid_return_type"===n.code)s(n.returnTypeError);else if("invalid_arguments"===n.code)s(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,s=0;for(;s<n.path.length;){const r=n.path[s];s===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],s++}}};return s(this),r}static assert(e){if(!(e instanceof n))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,s.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}t.ZodError=n,n.create=e=>new n(e)},857:e=>{e.exports=require("os")},892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},896:e=>{e.exports=require("fs")},918:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenStreamer=void 0;const s=r(537);t.ScreenStreamer=class{constructor(e,t){this.logger=e,this.status="stopped",this.currentHandle=null,this.minicapManager=new s.MinicapManager(e,t)}getStatus(){return this.status}isStreaming(){return"streaming"===this.status}async startStreaming(e,t){if("streaming"===this.status&&(this.logger.warn("Already streaming, stopping previous stream"),this.stopCurrentStream()),this.status="starting",!await this.minicapManager.ensureInstalled())return this.logger.error("Minicap not available - screen streaming disabled"),this.status="error",null;const r=await this.minicapManager.startStreaming(e.adbPath,e.deviceSerial,e.width??540,t);if(!r)return this.logger.error("Failed to start minicap streaming"),this.status="error",null;this.logger.info("Using minicap streaming (~30fps)"),this.status="streaming";const s={stop:()=>{r.stop(),this.status="stopped",this.currentHandle=null}};return this.currentHandle=s,s}stopCurrentStream(){this.currentHandle&&(this.currentHandle.stop(),this.currentHandle=null),this.status="stopped"}dispose(){this.stopCurrentStream(),this.minicapManager.dispose()}}},928:e=>{e.exports=require("path")},943:e=>{e.exports=require("fs/promises")},970:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createMcpTools=function(e){const t=new Map;for(const[r,s]of Object.entries(e))t.set(r,async e=>{let t=e;if(s.params){const n=s.params.safeParse(e);if(!n.success)throw new Error(`Invalid params for ${r}: ${n.error.message}`);t=n.data}const n=await s.impl(t);if(s.result){const e=s.result.safeParse(n);if(!e.success)throw new Error(`Invalid result for ${r}: ${e.error.message}`);return e.data}return n});const r=Object.entries(e).map(([e,t])=>{let r={type:"object",properties:{},required:[]};return t.params&&(r=(0,s.zodToJsonSchema)(t.params,{target:"openApi3",$refStrategy:"none"})),{name:e,description:t.description,parameters:JSON.stringify(r)}});return{call:async function(e,r){const s=t.get(e);if(!s)throw new Error(`Unknown tool: ${e}`);return s(r)},offerings:function(){return r}}};const s=r(522)}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,r),a.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s=r(184),n=exports;for(var a in s)n[a]=s[a];s.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();
//# sourceMappingURL=http://go/sourcemap/sourcemaps/4ca9b38c6c97d4243bf0c61e51426667cb964bd0/extensions/cursor-android-emulator-connect/dist/main.js.map